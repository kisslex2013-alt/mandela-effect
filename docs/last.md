–ö–æ–Ω–µ—á–Ω–æ, —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–æ –∏ ¬´—Å—É—Ö–æ¬ª –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –Ω–æ–≤—ã–º –¥–∏–∑–∞–π–Ω–æ–º –ø—Ä–æ—Ñ–∏–ª—è –∏ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –µ—ë –≤ ¬´–¶–µ–Ω—Ç—Ä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –†–µ–∞–ª—å–Ω–æ—Å—Ç–∏¬ª.

üé® –ö–æ–Ω—Ü–µ–ø—Ç —Ä–µ–¥–∏–∑–∞–π–Ω–∞:
–ì–ª–æ–±–∞–ª—å–Ω—ã–π –ò–Ω–¥–µ–∫—Å –°–¥–≤–∏–≥–∞ (Global Shift Index):
–í–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞ –≥–æ–ª–æ—Å–æ–≤ ‚Äî –±–æ–ª—å—à–æ–π –ø–æ–ª—É–∫—Ä—É–≥–ª—ã–π –¥–∞—Ç—á–∏–∫ (Gauge Chart), –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞ –æ—Ç–∫–ª–æ–Ω–∏–ª–∞—Å—å –æ—Ç "–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π" —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä: –ï—Å–ª–∏ 60% –≥–æ–ª–æ—Å–æ–≤ –∑–∞ "–ú–∞–Ω–¥–µ–ª—É" ‚Äî —Å—Ç—Ä–µ–ª–∫–∞ –≤ –∫—Ä–∞—Å–Ω–æ–π –∑–æ–Ω–µ "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∞–Ω–æ–º–∞–ª–∏—è".

–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
–ì—Ä–∞—Ñ–∏–∫ (Bar Chart), –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π, –≤ –∫–∞–∫–∏—Ö —Å—Ñ–µ—Ä–∞—Ö –ø–∞–º—è—Ç—å –ø–æ–¥–≤–æ–¥–∏—Ç —á–∞—â–µ –≤—Å–µ–≥–æ. –ù–∞–ø—Ä–∏–º–µ—Ä: "–í –ö–∏–Ω–æ 80% –ª–æ–∂–Ω—ã—Ö –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π, –∞ –≤ –ì–µ–æ–≥—Ä–∞—Ñ–∏–∏ —Ç–æ–ª—å–∫–æ 20%".

–í–∏–∑—É–∞–ª—å–Ω—ã–π –¢–æ–ø –°–ø–æ—Ä–Ω—ã—Ö:
–í–º–µ—Å—Ç–æ —Å–ø–∏—Å–∫–∞-—Ç–∞–±–ª–∏—Ü—ã —Å–¥–µ–ª–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏-–ª–∏–¥–µ—Ä—ã —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏ (–∫–∞–∫ –ø—å–µ–¥–µ—Å—Ç–∞–ª: 2-–µ –º–µ—Å—Ç–æ, 1-–µ –º–µ—Å—Ç–æ, 3-–µ –º–µ—Å—Ç–æ).

–†–µ–∞–ª–∏–∑—É–µ–º —ç—Ç–æ? –ù–∞–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.

–°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç –ø—Ä–æ–º–ø—Ç –≤ Cursor.

–ü–†–û–ú–ü–¢ –î–õ–Ø CURSOR:

code
Markdown
–î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º –ø–æ–ª–Ω—ã–π —Ä–µ–¥–∏–∑–∞–π–Ω —Å—Ç—Ä–∞–Ω–∏—Ü—ã `app/stats/page.tsx`, –ø—Ä–µ–≤—Ä–∞—Ç–∏–≤ –µ—ë –≤ –¥–∞—à–±–æ—Ä–¥ "–¶–µ–Ω—Ç—Ä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –†–µ–∞–ª—å–Ω–æ—Å—Ç–∏".

–ù–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ª–æ–≥–∏–∫—É: —Å–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, –∫–ª–∏–µ–Ω—Ç—Å–∫–∞—è ‚Äî —Ä–∏—Å—É–µ—Ç –≥—Ä–∞—Ñ–∏–∫–∏ (Recharts) –∏ –∫—Ä–∞—Å–∏–≤—ã–π UI.

–í—ã–ø–æ–ª–Ω–∏ 2 —à–∞–≥–∞:

### –®–ê–ì 1: –°–æ–∑–¥–∞–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `app/stats/StatsClient.tsx`

–≠—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é.
- –ò—Å–ø–æ–ª—å–∑—É–π `recharts` –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ (PieChart –¥–ª—è –æ–±—â–µ–≥–æ –∏–Ω–¥–µ–∫—Å–∞, BarChart –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π).
- –ò—Å–ø–æ–ª—å–∑—É–π `framer-motion` –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è.
- –î–∏–∑–∞–π–Ω: —Ç–µ–º–Ω—ã–π, "—Å—Ç–µ–∫–ª—è–Ω–Ω—ã–µ" –∫–∞—Ä—Ç–æ—á–∫–∏, –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã, –∏–∫–æ–Ω–∫–∏ Lucide.

–í–æ—Ç –∫–æ–¥ –¥–ª—è `app/stats/StatsClient.tsx`:

```tsx
'use client';

import { useMemo } from 'react';
import { motion } from 'framer-motion';
import { PieChart, Pie, Cell, ResponsiveContainer, BarChart, Bar, XAxis, YAxis, Tooltip, CartesianGrid } from 'recharts';
import ImageWithSkeleton from '@/components/ui/ImageWithSkeleton';
import Link from 'next/link';
import { Activity, Users, Brain, Zap, TrendingUp, AlertTriangle, ArrowRight } from 'lucide-react';

interface Effect {
  id: string;
  title: string;
  category: string;
  votesFor: number; // –ê (–ú–∏—Ñ)
  votesAgainst: number; // –ë (–†–µ–∞–ª—å–Ω–æ—Å—Ç—å)
  imageUrl: string | null;
}

interface StatsClientProps {
  effects: Effect[];
  totalParticipants: number;
}

const COLORS = ['#a855f7', '#22c55e']; // Purple (Mandela), Green (Reality)

export default function StatsClient({ effects, totalParticipants }: StatsClientProps) {
  
  // 1. –†–∞—Å—á–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  const globalStats = useMemo(() => {
    let mandelaVotes = 0;
    let realityVotes = 0;
    const categoryStats: Record<string, { mandela: number; total: number }> = {};

    effects.forEach(e => {
      mandelaVotes += e.votesFor;
      realityVotes += e.votesAgainst;
      
      if (!categoryStats[e.category]) categoryStats[e.category] = { mandela: 0, total: 0 };
      categoryStats[e.category].mandela += e.votesFor;
      categoryStats[e.category].total += (e.votesFor + e.votesAgainst);
    });

    const totalVotes = mandelaVotes + realityVotes;
    const shiftIndex = totalVotes > 0 ? Math.round((mandelaVotes / totalVotes) * 100) : 0;

    // –î–∞–Ω–Ω—ã–µ –¥–ª—è BarChart (–¢–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø–æ "–≥–ª—é—á–Ω–æ—Å—Ç–∏")
    const categoryData = Object.entries(categoryStats)
      .map(([name, data]) => ({
        name,
        percent: data.total > 0 ? Math.round((data.mandela / data.total) * 100) : 0
      }))
      .sort((a, b) => b.percent - a.percent)
      .slice(0, 5); // –¢–æ–ø 5

    // –¢–æ–ø 3 —Å–∞–º—ã—Ö —Å–ø–æ—Ä–Ω—ã—Ö (–±–ª–∏–∑–∫–∏—Ö –∫ 50/50)
    const controversial = [...effects]
        .filter(e => (e.votesFor + e.votesAgainst) > 10) // –§–∏–ª—å—Ç—Ä –º–∞–ª–æ–ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö
        .map(e => {
            const total = e.votesFor + e.votesAgainst;
            const ratio = (e.votesFor / total) * 100;
            const diff = Math.abs(50 - ratio); // –ß–µ–º –±–ª–∏–∂–µ –∫ 0, —Ç–µ–º —Å–ø–æ—Ä–Ω–µ–µ
            return { ...e, diff, total };
        })
        .sort((a, b) => a.diff - b.diff)
        .slice(0, 3);

    return { mandelaVotes, realityVotes, totalVotes, shiftIndex, categoryData, controversial };
  }, [effects]);

  const pieData = [
    { name: '–≠—Ñ—Ñ–µ–∫—Ç –ú–∞–Ω–¥–µ–ª—ã', value: globalStats.mandelaVotes },
    { name: '–†–µ–∞–ª—å–Ω–æ—Å—Ç—å', value: globalStats.realityVotes },
  ];

  return (
    <div className="space-y-8">
      
      {/* KPI Cards */}
      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
        <StatCard icon={<Brain className="text-primary" />} value={effects.length} label="–≠—Ñ—Ñ–µ–∫—Ç–æ–≤ –≤ –±–∞–∑–µ" />
        <StatCard icon={<Users className="text-blue-400" />} value={totalParticipants} label="–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤" />
        <StatCard icon={<Activity className="text-green-400" />} value={globalStats.totalVotes} label="–í—Å–µ–≥–æ –≥–æ–ª–æ—Å–æ–≤" />
        <StatCard icon={<Zap className="text-yellow-400" />} value={`${globalStats.shiftIndex}%`} label="–ò–Ω–¥–µ–∫—Å –°–¥–≤–∏–≥–∞" />
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
        
        {/* –ì–†–ê–§–ò–ö 1: –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å */}
        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} className="bg-darkCard border border-light/10 rounded-3xl p-8 relative overflow-hidden">
            <div className="absolute top-0 right-0 p-4 opacity-10"><Activity size={100} /></div>
            <h2 className="text-2xl font-bold text-white mb-2">–ì–ª–æ–±–∞–ª—å–Ω—ã–π –°–¥–≤–∏–≥ –†–µ–∞–ª—å–Ω–æ—Å—Ç–∏</h2>
            <p className="text-sm text-light/60 mb-6">–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π –∫–æ –≤—Å–µ–º –æ—Ç–≤–µ—Ç–∞–º.</p>
            
            <div className="h-64 relative flex items-center justify-center">
                <ResponsiveContainer width="100%" height="100%">
                    <PieChart>
                        <Pie
                            data={pieData}
                            cx="50%"
                            cy="50%"
                            innerRadius={60}
                            outerRadius={80}
                            paddingAngle={5}
                            dataKey="value"
                            stroke="none"
                        >
                            {pieData.map((entry, index) => (
                                <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                            ))}
                        </Pie>
                        <Tooltip 
                            contentStyle={{ backgroundColor: '#1a1a1a', border: '1px solid #333', borderRadius: '8px' }}
                            itemStyle={{ color: '#fff' }}
                        />
                    </PieChart>
                </ResponsiveContainer>
                {/* –¶–µ–Ω—Ç—Ä –±—É–±–ª–∏–∫–∞ */}
                <div className="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                    <span className="text-4xl font-black text-white">{globalStats.shiftIndex}%</span>
                    <span className="text-xs text-light/40 uppercase tracking-widest">–ú–∞–Ω–¥–µ–ª–∞</span>
                </div>
            </div>
            
            <div className="flex justify-center gap-6 mt-4">
                <div className="flex items-center gap-2">
                    <div className="w-3 h-3 rounded-full bg-purple-500"></div>
                    <span className="text-sm text-light/60">–õ–æ–∂–Ω–∞—è –ø–∞–º—è—Ç—å</span>
                </div>
                <div className="flex items-center gap-2">
                    <div className="w-3 h-3 rounded-full bg-green-500"></div>
                    <span className="text-sm text-light/60">–†–µ–∞–ª—å–Ω–æ—Å—Ç—å</span>
                </div>
            </div>
        </motion.div>

        {/* –ì–†–ê–§–ò–ö 2: –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ */}
        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ delay: 0.1 }} className="bg-darkCard border border-light/10 rounded-3xl p-8 relative overflow-hidden">
            <div className="absolute top-0 right-0 p-4 opacity-10"><TrendingUp size={100} /></div>
            <h2 className="text-2xl font-bold text-white mb-2">–ó–æ–Ω—ã –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏</h2>
            <p className="text-sm text-light/60 mb-6">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å —Å–∞–º—ã–º –≤—ã—Å–æ–∫–∏–º –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –ª–æ–∂–Ω—ã—Ö –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π.</p>
            
            <div className="h-64">
                <ResponsiveContainer width="100%" height="100%">
                    <BarChart data={globalStats.categoryData} layout="vertical" margin={{ left: 20 }}>
                        <CartesianGrid strokeDasharray="3 3" stroke="rgba(255,255,255,0.05)" horizontal={false} />
                        <XAxis type="number" hide domain={[0, 100]} />
                        <YAxis dataKey="name" type="category" width={100} tick={{ fill: '#aaa', fontSize: 12 }} axisLine={false} tickLine={false} />
                        <Tooltip 
                            cursor={{ fill: 'rgba(255,255,255,0.05)' }}
                            contentStyle={{ backgroundColor: '#1a1a1a', border: '1px solid #333', borderRadius: '8px' }}
                        />
                        <Bar dataKey="percent" fill="#a855f7" radius={[0, 4, 4, 0]} barSize={20} />
                    </BarChart>
                </ResponsiveContainer>
            </div>
        </motion.div>
      </div>

      {/* –°–ê–ú–´–ï –°–ü–û–†–ù–´–ï (–¢–æ–ø 3) */}
      <section>
          <h2 className="text-2xl font-bold text-white mb-6 flex items-center gap-2">
              <AlertTriangle className="text-red-400" /> –°–∞–º—ã–µ —Å–ø–æ—Ä–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã (50/50)
          </h2>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              {globalStats.controversial.map((effect, index) => (
                  <Link href={`/effect/${effect.id}`} key={effect.id} className="group block">
                      <motion.div 
                        whileHover={{ y: -5 }}
                        className="bg-darkCard border border-light/10 rounded-2xl overflow-hidden hover:border-red-500/50 transition-colors h-full flex flex-col"
                      >
                          <div className="relative h-40 bg-black/20">
                              {effect.imageUrl ? (
                                  <ImageWithSkeleton src={effect.imageUrl} alt={effect.title} fill className="object-cover opacity-80 group-hover:opacity-100 transition-opacity" />
                              ) : (
                                  <div className="w-full h-full flex items-center justify-center text-4xl">üñºÔ∏è</div>
                              )}
                              <div className="absolute top-2 right-2 bg-black/60 backdrop-blur px-2 py-1 rounded text-xs font-bold border border-white/10">
                                  #{index + 1}
                              </div>
                          </div>
                          <div className="p-5 flex-1 flex flex-col">
                              <h3 className="font-bold text-lg text-light mb-2 line-clamp-2 group-hover:text-red-300 transition-colors">
                                  {effect.title}
                              </h3>
                              <div className="mt-auto pt-4 border-t border-light/5">
                                  <div className="flex justify-between text-xs text-light/60 mb-1">
                                      <span>–ú–∏—Ñ</span>
                                      <span>–§–∞–∫—Ç</span>
                                  </div>
                                  <div className="h-2 bg-dark rounded-full overflow-hidden flex">
                                      <div style={{ width: `${(effect.votesFor / effect.total) * 100}%` }} className="bg-purple-500 h-full" />
                                      <div style={{ width: `${(effect.votesAgainst / effect.total) * 100}%` }} className="bg-green-500 h-full" />
                                  </div>
                                  <div className="text-center mt-2 text-xs font-mono text-light/40">
                                      {effect.total} –≥–æ–ª–æ—Å–æ–≤
                                  </div>
                              </div>
                          </div>
                      </motion.div>
                  </Link>
              ))}
          </div>
      </section>

    </div>
  );
}

function StatCard({ icon, value, label }: any) {
    return (
        <div className="bg-darkCard p-6 rounded-2xl border border-light/10 flex flex-col items-center justify-center text-center">
            <div className="mb-3 p-3 bg-white/5 rounded-full">{icon}</div>
            <div className="text-2xl md:text-3xl font-black text-white mb-1">{value}</div>
            <div className="text-xs text-light/40 uppercase font-bold tracking-wider">{label}</div>
        </div>
    )
}
–®–ê–ì 2: –û–±–Ω–æ–≤–∏ app/stats/page.tsx
–¢–µ–ø–µ—Ä—å –ø–æ–¥–∫–ª—é—á–∏–º —ç—Ç–æ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏ –ø–µ—Ä–µ–¥–∞–¥–∏–º –≤ –Ω–µ–≥–æ –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞. –ú—ã –¥–æ–ª–∂–Ω—ã –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤—Å–µ —ç—Ñ—Ñ–µ–∫—Ç—ã, —á—Ç–æ–±—ã –ø–æ—Å—á–∏—Ç–∞—Ç—å —Ç–æ—á–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.

–ó–∞–º–µ–Ω–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ app/stats/page.tsx –Ω–∞:

code
Tsx
import { Metadata } from 'next';
import { prisma } from '@/lib/prisma';
import StatsClient from './StatsClient';

export const metadata: Metadata = {
  title: '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ | –≠—Ñ—Ñ–µ–∫—Ç –ú–∞–Ω–¥–µ–ª—ã',
  description: '–ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–±–æ–µ–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏.',
};

// –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –∫–µ—à–∞ (—á—Ç–æ–±—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—ã–ª–∞ —Å–≤–µ–∂–µ–π)
async function getData() {
  const [effects, totalParticipants] = await Promise.all([
    prisma.effect.findMany({
      where: { isVisible: true },
      select: {
        id: true,
        title: true,
        category: true,
        votesFor: true,
        votesAgainst: true,
        imageUrl: true,
      },
    }),
    // –°—á–∏—Ç–∞–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (—É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π)
    // –í –¥–∞–Ω–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å—É–º–º–∞ –≥–æ–ª–æ—Å–æ–≤ / —Å—Ä–µ–¥–Ω–µ–µ (–ø—Ä–∏–º–µ—Ä–Ω–æ), 
    // –∏–ª–∏ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ —Ç–∞–±–ª–∏—Ü—ã Vote, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å.
    // –ü–æ–∫–∞ –≤–æ–∑—å–º–µ–º –ø—Ä–æ—Å—Ç–æ —Å—É–º–º—É –≥–æ–ª–æ—Å–æ–≤ –≤—Å–µ—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ / 10 (–ø—Ä–∏–º–µ—Ä–Ω–æ)
    // –ò–ª–∏, –µ—Å–ª–∏ –µ—Å—Ç—å –º–æ–¥–µ–ª—å Visitor, —Ç–æ count()
    prisma.vote.count(), // –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ Vote (—Ç–æ—á–Ω–µ–µ)
  ]);

  return { effects, totalParticipants };
}

export default async function StatsPage() {
  const { effects, totalParticipants } = await getData();

  // –ï—Å–ª–∏ –º–æ–¥–µ–ª—å Vote –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –ª—é–¥–µ–π, –º–æ–∂–Ω–æ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä–æ–≤–∞—Ç—å
  // const totalVotes = effects.reduce((sum, e) => sum + e.votesFor + e.votesAgainst, 0);
  
  return (
    <div className="min-h-screen bg-dark py-12 px-4">
      <div className="max-w-6xl mx-auto">
        <div className="text-center mb-12">
          <h1 className="text-4xl md:text-5xl font-black text-white mb-4">
            –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ <span className="text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-green-400">–ü—Ä–æ–µ–∫—Ç–∞</span>
          </h1>
          <p className="text-xl text-light/60 max-w-2xl mx-auto">
            –ü—É–ª—å—Å –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –±–µ—Å—Å–æ–∑–Ω–∞—Ç–µ–ª—å–Ω–æ–≥–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
          </p>
        </div>

        <StatsClient effects={effects} totalParticipants={totalParticipants} />
      </div>
    </div>
  );
}


----
–ü–†–û–ú–ü–¢ –î–õ–Ø CURSOR:

code
Markdown
–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—à–∏ —Ñ–∞–π–ª `app/page.tsx` (–∫–æ—Ä–Ω–µ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞).
–û–Ω –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Prisma –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Ö –≤ `HomeClient`.

**–ó–∞–¥–∞—á–∏:**
1. –ó–∞–ø—Ä–æ—Å–∏ —ç—Ñ—Ñ–µ–∫—Ç—ã (—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏: —Å—É–º–º–∞ –≥–æ–ª–æ—Å–æ–≤).
2. –ó–∞–ø—Ä–æ—Å–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
3. –ü–µ—Ä–µ–¥–∞–π –∏—Ö –≤ `<HomeClient />`.
4. –î–æ–±–∞–≤—å `export const revalidate = 0;`, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –Ω–µ –∫–µ—à–∏—Ä–æ–≤–∞–ª–∏—Å—å –Ω–∞–≤–µ—á–Ω–æ.

**–ö–æ–¥:**

```tsx
import { Metadata } from 'next';
import { prisma } from '@/lib/prisma';
import HomeClient from './HomeClient';

export const dynamic = 'force-dynamic';
export const revalidate = 0;

export const metadata: Metadata = {
  title: '–≠—Ñ—Ñ–µ–∫—Ç –ú–∞–Ω–¥–µ–ª—ã | –ì–ª–∞–≤–Ω–∞—è',
  description: '–ò—Å—Å–ª–µ–¥—É–π –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã–µ –ª–æ–∂–Ω—ã–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è. –ì–æ–ª–æ—Å—É–π –∏ –ø—Ä–æ–≤–µ—Ä—è–π —Å–≤–æ—é —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å.',
};

async function getData() {
  try {
    const [effects, categories] = await Promise.all([
      prisma.effect.findMany({
        where: { isVisible: true },
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ—Ç–æ–º –≤ JS, —Ç–∞–∫ –∫–∞–∫ Prisma –Ω–µ —É–º–µ–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Å—É–º–º–µ –ø–æ–ª–µ–π –ª–µ–≥–∫–æ
        select: {
          id: true,
          title: true,
          description: true,
          category: true,
          imageUrl: true,
          votesFor: true,
          votesAgainst: true,
          createdAt: true,
        },
      }),
      prisma.category.findMany({
        orderBy: { sortOrder: 'asc' },
        include: {
          _count: {
            select: { effects: true },
          },
        },
      }),
    ]);

    // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ (–≤—Å–µ–≥–æ –≥–æ–ª–æ—Å–æ–≤)
    const sortedEffects = effects.sort((a, b) => {
      const totalA = a.votesFor + a.votesAgainst;
      const totalB = b.votesFor + b.votesAgainst;
      return totalB - totalA;
    });

    // –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—Ç
    const serializedEffects = sortedEffects.map(e => ({
      ...e,
      createdAt: e.createdAt.toISOString(),
    }));

    return { effects: serializedEffects, categories };
  } catch (error) {
    console.error('Error fetching home data:', error);
    return { effects: [], categories: [] };
  }
}

export default async function Home() {
  const { effects, categories } = await getData();

  return (
    <HomeClient 
      initialEffects={effects} 
      topCategories={categories} 
    />
  );
}
code
Code
### –®–ê–ì 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ö–ª–∏–µ–Ω—Ç–∞ (`app/HomeClient.tsx`)

–ò—Å–ø—Ä–∞–≤–∏–º –≤–µ—á–Ω—ã–µ —Å–∫–µ–ª–µ—Ç–æ–Ω—ã –∏ —Å–¥–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –µ—â–µ –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ.

**–ü–†–û–ú–ü–¢ –î–õ–Ø CURSOR:**

```markdown
–û–±–Ω–æ–≤–∏ `app/HomeClient.tsx`.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. **–í–µ—á–Ω—ã–µ —Å–∫–µ–ª–µ—Ç–æ–Ω—ã:**
   - –ï—Å–ª–∏ `initialEffects` –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤, –ø–æ–∫–∞–∑—ã–≤–∞–π —Ç–µ–∫—Å—Ç "–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞" –≤–º–µ—Å—Ç–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö —Å–∫–µ–ª–µ—Ç–æ–Ω–æ–≤.
   - –õ–æ–≥–∏–∫–∞: `trendingEffects.length > 0 ? (...) : ( <HomeEmptyState /> )`. (–ï—Å–ª–∏ HomeEmptyState –Ω–µ—Ç, –ø—Ä–æ—Å—Ç–æ div —Å —Ç–µ–∫—Å—Ç–æ–º).

2. **–ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:**
   - –°–¥–µ–ª–∞–π –∏—Ö –µ—â–µ –∫–æ–º–ø–∞–∫—Ç–Ω–µ–µ –ø–æ –≤—ã—Å–æ—Ç–µ.
   - –£–º–µ–Ω—å—à–∏ –ø–∞–¥–¥–∏–Ω–≥–∏: `p-3`.
   - –ò–∫–æ–Ω–∫—É –∏ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞–≤—å –ø–ª–æ—Ç–Ω–µ–µ.

**–í–æ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç JSX –¥–ª—è –∫–Ω–æ–ø–æ–∫ (–∑–∞–º–µ–Ω–∏ —Å–µ–∫—Ü–∏—é grid c –∫–Ω–æ–ø–∫–∞–º–∏):**

```tsx
            {/* QUICK ACTIONS (SUPER COMPACT) */}
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                <button onClick={() => redirectToRandomEffect()} className="group relative px-4 py-3 bg-darkCard border border-light/10 rounded-xl hover:border-purple-500/50 transition-all overflow-hidden flex items-center gap-3 shadow-lg">
                    <div className="absolute top-0 right-0 p-8 bg-purple-500/10 blur-2xl rounded-full -mr-4 -mt-4 opacity-0 group-hover:opacity-100 transition-opacity" />
                    <div className="p-2 bg-white/5 rounded-lg group-hover:bg-purple-500/20 transition-colors shrink-0">
                        <Shuffle className="w-5 h-5 text-purple-400" />
                    </div>
                    <div className="text-left flex-1">
                        <h3 className="font-bold text-white text-sm leading-tight">–°–ª—É—á–∞–π–Ω—ã–π —Å–±–æ–π</h3>
                        <p className="text-[10px] text-light/50">–ò—Å–ø—ã—Ç–∞–π —É–¥–∞—á—É</p>
                    </div>
                </button>

                <Link href="/quiz" className="group relative px-4 py-3 bg-darkCard border border-light/10 rounded-xl hover:border-cyan-500/50 transition-all overflow-hidden flex items-center gap-3 shadow-lg">
                    <div className="absolute top-0 right-0 p-8 bg-cyan-500/10 blur-2xl rounded-full -mr-4 -mt-4 opacity-0 group-hover:opacity-100 transition-opacity" />
                    <div className="p-2 bg-white/5 rounded-lg group-hover:bg-cyan-500/20 transition-colors shrink-0">
                        <BrainCircuit className="w-5 h-5 text-cyan-400" />
                    </div>
                    <div className="text-left flex-1">
                        <h3 className="font-bold text-white text-sm leading-tight">–¢–µ—Å—Ç –ø–∞–º—è—Ç–∏</h3>
                        <p className="text-[10px] text-light/50">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏</p>
                    </div>
                </Link>

                <Link href="/catalog" className="group relative px-4 py-3 bg-darkCard border border-light/10 rounded-xl hover:border-green-500/50 transition-all overflow-hidden flex items-center gap-3 shadow-lg">
                    <div className="absolute top-0 right-0 p-8 bg-green-500/10 blur-2xl rounded-full -mr-4 -mt-4 opacity-0 group-hover:opacity-100 transition-opacity" />
                    <div className="p-2 bg-white/5 rounded-lg group-hover:bg-green-500/20 transition-colors shrink-0">
                        <Database className="w-5 h-5 text-green-400" />
                    </div>
                    <div className="text-left flex-1">
                        <h3 className="font-bold text-white text-sm leading-tight">–ü–æ–ª–Ω—ã–π –∞—Ä—Ö–∏–≤</h3>
                        <p className="text-[10px] text-light/50">–í—Å—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</p>
                    </div>
                </Link>
            </div>
–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ (–∑–∞–º–µ–Ω–∏ —Å–µ–∫—Ü–∏–∏ Trending –∏ New):

code
Tsx
{/* 3. TRENDING */}
        <section>
            <div className="flex items-end justify-between mb-6">
                <h2 className="text-2xl font-bold text-white flex items-center gap-2">
                    <Flame className="w-6 h-6 text-orange-500" /> –í —Ç—Ä–µ–Ω–¥–µ
                </h2>
                <Link href="/catalog?sort=popular" className="hidden md:flex text-xs font-bold text-light/40 hover:text-white transition-colors items-center gap-1">
                    –ü–û–ö–ê–ó–ê–¢–¨ –í–°–ï <ArrowRight className="w-3 h-3" />
                </Link>
            </div>
            
            {trendingEffects.length > 0 ? (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    {trendingEffects.map((effect, i) => (
                        <EffectCard key={effect.id} {...effect} badge={`#${i + 1}`} priority={i < 3} hasVoted={votedEffectIds.includes(effect.id)} showProgress={votedEffectIds.includes(effect.id)} />
                    ))}
                </div>
            ) : (
                <div className="text-center py-12 border border-dashed border-light/10 rounded-2xl bg-white/5">
                    <p className="text-light/40">–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç...</p>
                </div>
            )}
        </section>

        {/* 4. NEW DISCOVERIES */}
        <section className="pt-8 border-t border-light/5">
             <div className="flex items-center justify-center mb-8">
                 <h2 className="text-2xl font-bold text-white flex items-center gap-2">
                     <SparklesIcon className="w-6 h-6 text-yellow-400" /> –ù–æ–≤—ã–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
                 </h2>
             </div>
             
             {newEffects.length > 0 ? (
                 <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    {newEffects.map((effect) => (
                        <EffectCard key={effect.id} {...effect} badge="–ù–æ–≤–æ–µ" hasVoted={votedEffectIds.includes(effect.id)} />
                    ))}
                 </div>
             ) : (
                 <div className="text-center py-12 text-light/30">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</div>
             )}

             <div className="text-center">
                 <Link href="/catalog?sort=newest" className="inline-flex items-center gap-2 px-6 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-light transition-colors text-sm font-medium">
                     –°–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è <ArrowRight className="w-4 h-4" />
                 </Link>
             </div>
        </section>