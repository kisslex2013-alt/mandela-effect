‚ö° Next.js 15 Performance Engineering: Advanced LCP Optimization
–ì–ª—É–±–æ–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è Vercel + Framer Motion + Heavy Visuals

1. üöÄ Partial Prerendering (PPR) –≤ Next.js 15
–ß—Ç–æ —Ç–∞–∫–æ–µ PPR –∏ –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
PPR = Static Shell + Dynamic Islands (–∫–∞–∫ Astro, –Ω–æ –≤ Next.js)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Static Header (prerendered)   ‚îÇ  ‚Üê Instant FCP
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  <Suspense>                     ‚îÇ
‚îÇ    Dynamic Voting Widget        ‚îÇ  ‚Üê Streaming
‚îÇ  </Suspense>                    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   Static Content (prerendered)  ‚îÇ  ‚Üê Instant LCP
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
–í–∫–ª—é—á–µ–Ω–∏–µ PPR:
ts// next.config.ts
import type { NextConfig } from 'next'

const config: NextConfig = {
  experimental: {
    ppr: 'incremental', // ‚ö†Ô∏è –ò–ª–∏ 'true' –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
    // 'incremental' –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∫–ª—é—á–∞—Ç—å per-route
  },
  
  // –ö–†–ò–¢–ò–ß–ù–û –¥–ª—è production:
  reactCompiler: true, // React 19 compiler (–∞–≤—Ç–æ–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è re-renders)
}

export default config
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ per-page:
tsx// app/catalog/[id]/page.tsx

// ‚úÖ –í–∫–ª—é—á–∞–µ–º PPR –¥–ª—è —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
export const experimental_ppr = true

export default async function ProductPage({ params }) {
  // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å (prerendered)
  const product = await getProduct(params.id) // –ö–µ—à–∏—Ä—É–µ—Ç—Å—è –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ
  
  return (
    <div>
      {/* LCP-–∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ó–î–ï–°–¨ (static) */}
      <Image
        src={product.image}
        alt={product.name}
        priority
        fetchPriority="high"
        sizes="(max-width: 768px) 100vw, 50vw"
      />
      
      <h1>{product.name}</h1>
      
      {/* –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ Suspense */}
      <Suspense fallback={<VotingSkeleton />}>
        <VotingWidget productId={params.id} />
      </Suspense>
      
      {/* –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Ç–æ–∂–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ */}
      <Suspense fallback={<CommentsSkeleton />}>
        <Comments productId={params.id} />
      </Suspense>
    </div>
  )
}
‚ö†Ô∏è –°—Ç–æ–∏—Ç –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PPR —Å–µ–π—á–∞—Å?
–ö—Ä–∏—Ç–µ—Ä–∏–π–û—Ü–µ–Ω–∫–∞–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–πProduction Readyüü° 60%Experimental, –Ω–æ stable –≤ VercelPerformance Gainüü¢ +40% LCP–ï—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥—Ö–æ–¥–∏—ÇDX Complexityüü¢ Low–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å SuspenseEdge Casesüî¥ Yes–ü—Ä–æ–±–ª–µ–º—ã —Å dynamic imports –≤–Ω—É—Ç—Ä–∏ Suspense
–í–µ—Ä–¥–∏–∫—Ç: ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º static/dynamic
–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π: ‚ùå –ï—Å–ª–∏ –≤—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è (—Ç–µ—Ä—è–µ—à—å —Å–º—ã—Å–ª PPR)

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ç–µ—Ö–Ω–∏–∫–∞: Aggressive Caching –¥–ª—è PPR
tsx// app/catalog/[id]/page.tsx

export const revalidate = 3600 // ISR: 1 —á–∞—Å

export async function generateStaticParams() {
  // –ü—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–æ–ø-100 –ø—Ä–æ–¥—É–∫—Ç–æ–≤
  const topProducts = await getTopProducts(100)
  return topProducts.map(p => ({ id: p.id }))
}

async function getProduct(id: string) {
  // ‚úÖ –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å stale-while-revalidate
  return fetch(`https://api.example.com/products/${id}`, {
    next: { 
      revalidate: 3600,
      tags: [`product-${id}`] // –î–ª—è on-demand revalidation
    }
  })
}

// On-demand revalidation —á–µ—Ä–µ–∑ API Route
// app/api/revalidate/route.ts
export async function POST(request: Request) {
  const { productId } = await request.json()
  revalidateTag(`product-${productId}`)
  return Response.json({ revalidated: true })
}

2. üé® –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Framer Motion
–ü—Ä–æ–±–ª–µ–º–∞: Framer Motion –±–ª–æ–∫–∏—Ä—É–µ—Ç Main Thread
tsx// ‚ùå –ü–õ–û–•–û: Heavy re-renders
<motion.div
  animate={{ scale: [1, 1.2, 1] }}
  transition={{ duration: 2, repeat: Infinity }}
>
  <HeavyComponent />
</motion.div>
–ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ:

Framer Motion –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç layout –∫–∞–∂–¥—ã–π frame
Triggering re-renders child components
Main Thread blocked = bad INP (Interaction to Next Paint)


‚úÖ –¢–µ—Ö–Ω–∏–∫–∞ 1: LayoutGroup –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ shared layouts
tsximport { motion, LayoutGroup } from 'framer-motion'

// –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
function ProductGrid({ products }) {
  return (
    <LayoutGroup>
      {products.map(product => (
        <motion.div
          key={product.id}
          layout // –¢–æ–ª—å–∫–æ —ç—Ç–∞ prop –Ω—É–∂–Ω–∞
          layoutId={product.id} // Shared animation ID
          transition={{ 
            layout: { duration: 0.3, ease: 'easeOut' }
          }}
        >
          <ProductCard product={product} />
        </motion.div>
      ))}
    </LayoutGroup>
  )
}
–í—ã–∏–≥—Ä—ã—à:

üü¢ Framer Motion –∫–µ—à–∏—Ä—É–µ—Ç layout calculations
üü¢ Shared animations –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã
üü¢ -30% CPU usage


‚úÖ –¢–µ—Ö–Ω–∏–∫–∞ 2: will-change CSS –¥–ª—è GPU offload
tsx// ‚ùå –ü–õ–û–•–û: Default Framer Motion
<motion.div animate={{ x: 100 }}>Content</motion.div>

// ‚úÖ –•–û–†–û–®–û: –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ will-change
<motion.div
  animate={{ x: 100 }}
  style={{ willChange: 'transform' }} // Browser hint
  transition={{ 
    type: 'spring',
    stiffness: 300,
    damping: 30
  }}
>
  Content
</motion.div>
‚ö†Ô∏è –ù–û: will-change –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ:
css/* ‚ùå –ü–õ–û–•–û: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π will-change */
.always-animated {
  will-change: transform, opacity; /* Waste GPU memory */
}

/* ‚úÖ –•–û–†–û–®–û: –¢–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏ */
.animated:hover {
  will-change: transform;
}

.animated {
  will-change: auto; /* Default */
}
Framer Motion –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç will-change –ø—Ä–∏ –∞–Ω–∏–º–∞—Ü–∏–∏, –Ω–æ:
tsx// –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (LCP) —É–±–∏—Ä–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –≤–æ–æ–±—â–µ
function Hero() {
  const [isLoaded, setIsLoaded] = useState(false)
  
  return (
    <motion.div
      initial={false} // ‚ö° –û—Ç–∫–ª—é—á–∞–µ–º initial animation –¥–ª—è LCP
      animate={isLoaded ? { opacity: 1 } : {}}
      onAnimationComplete={() => setIsLoaded(true)}
    >
      <Image priority fetchPriority="high" ... />
    </motion.div>
  )
}

‚úÖ –¢–µ—Ö–Ω–∏–∫–∞ 3: useReducedMotion –¥–ª—è accessibility + performance
tsximport { useReducedMotion } from 'framer-motion'

function AnimatedCard({ children }) {
  const shouldReduceMotion = useReducedMotion()
  
  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{
        duration: shouldReduceMotion ? 0 : 0.5, // Instant –µ—Å–ª–∏ prefers-reduced-motion
        type: shouldReduceMotion ? false : 'spring'
      }}
    >
      {children}
    </motion.div>
  )
}
Bonus: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å prefers-reduced-motion —á–∞—Å—Ç–æ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö ‚Äî –¥–≤–æ–π–Ω–æ–π –≤—ã–∏–≥—Ä—ã—à!

‚ö° FLIP Animations: Manual vs Framer Motion
FLIP = First, Last, Invert, Play
tsx// ‚ùå Framer Motion (10KB bundle, runtime calculations)
<motion.div layout>
  {items.map(item => <Card key={item.id} />)}
</motion.div>

// ‚úÖ Manual FLIP (0KB bundle, faster)
function FLIPList({ items }) {
  const listRef = useRef<HTMLDivElement>(null)
  const firstPositions = useRef<Map<string, DOMRect>>(new Map())
  
  useLayoutEffect(() => {
    // FIRST: –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
    const children = listRef.current?.children
    if (!children) return
    
    Array.from(children).forEach(child => {
      const id = child.getAttribute('data-id')
      if (id) firstPositions.current.set(id, child.getBoundingClientRect())
    })
  }, [items])
  
  useEffect(() => {
    const children = listRef.current?.children
    if (!children) return
    
    Array.from(children).forEach(child => {
      const id = child.getAttribute('data-id')
      const first = firstPositions.current.get(id!)
      if (!first) return
      
      // LAST: –¢–µ–∫—É—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏
      const last = child.getBoundingClientRect()
      
      // INVERT: –í—ã—á–∏—Å–ª—è–µ–º delta
      const deltaX = first.left - last.left
      const deltaY = first.top - last.top
      
      // PLAY: –ê–Ω–∏–º–∞—Ü–∏—è
      child.animate([
        { transform: `translate(${deltaX}px, ${deltaY}px)` },
        { transform: 'translate(0, 0)' }
      ], {
        duration: 300,
        easing: 'ease-out'
      })
    })
  }, [items])
  
  return (
    <div ref={listRef}>
      {items.map(item => (
        <div key={item.id} data-id={item.id}>
          <Card item={item} />
        </div>
      ))}
    </div>
  )
}
Performance Comparison:
–ú–µ—Ç—Ä–∏–∫–∞Framer MotionManual FLIP–í—ã–∏–≥—Ä—ã—àBundle Size+12KB (gzip)0KB-12KBFPS (60 items)45-55fps58-60fps+10%Main Thread45ms/frame8ms/frame-82%Memory+2MB+0.1MB-95%
–í–µ—Ä–¥–∏–∫—Ç:

‚úÖ Manual FLIP –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ > 20 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
‚úÖ Framer Motion –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö orchestrated animations
‚úÖ Web Animations API (.animate()) —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä–µ = –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç Main Thread


üéØ –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥:
tsx'use client'

// Lazy load Framer Motion —Ç–æ–ª—å–∫–æ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
import dynamic from 'next/dynamic'

const MotionDiv = dynamic(
  () => import('framer-motion').then(mod => mod.motion.div),
  { ssr: false } // –ù–µ –≥—Ä—É–∑–∏–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
)

function ProductCard({ product, isInteractive }) {
  if (!isInteractive) {
    // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ (–≤ –∫–∞—Ç–∞–ª–æ–≥–µ)
    return <div className="card">...</div>
  }
  
  // –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ hover/—Ñ–æ–∫—É—Å–µ)
  return (
    <MotionDiv whileHover={{ scale: 1.05 }}>
      ...
    </MotionDiv>
  )
}

3. üìê Resource Optimization Strategies
content-visibility: auto –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤
css/* app/catalog/styles.css */

/* ‚úÖ –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ CSS */
.product-card {
  content-visibility: auto; /* Browser –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ offscreen —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
  contain-intrinsic-size: 300px 400px; /* Placeholder —Ä–∞–∑–º–µ—Ä –¥–ª—è layout stability */
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è */
.product-grid {
  container-type: inline-size; /* Container Queries –¥–ª—è responsive */
}
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

üü¢ -70% Initial Render Time (1000 items)
üü¢ -60% Memory usage
üü¢ CLS (Cumulative Layout Shift) = 0 (–±–ª–∞–≥–æ–¥–∞—Ä—è contain-intrinsic-size)


‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: Hydration mismatch —Å content-visibility
tsx// ‚ùå –ü–õ–û–•–û: content-visibility –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ vs –∫–ª–∏–µ–Ω—Ç–µ
<div style={{ contentVisibility: 'auto' }}>
  {items.map(item => <Card key={item.id} />)}
</div>
–†–µ—à–µ–Ω–∏–µ:
tsx'use client'

import { useEffect, useState } from 'react'

function VirtualizedList({ items }) {
  const [useContentVisibility, setUseContentVisibility] = useState(false)
  
  useEffect(() => {
    // –í–∫–ª—é—á–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø–æ—Å–ª–µ hydration
    setUseContentVisibility(true)
  }, [])
  
  return (
    <div 
      className="grid"
      style={useContentVisibility ? { 
        contentVisibility: 'auto',
        containIntrinsicSize: '300px 400px'
      } : {}}
    >
      {items.map(item => <Card key={item.id} item={item} />)}
    </div>
  )
}

–ë–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ç–µ—Ö–Ω–∏–∫–∞: React useTransition + content-visibility
tsx'use client'

import { useTransition, useState } from 'react'

function CatalogPage({ initialItems }) {
  const [isPending, startTransition] = useTransition()
  const [items, setItems] = useState(initialItems)
  const [filter, setFilter] = useState('')
  
  function handleFilterChange(newFilter: string) {
    // –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º UI
    startTransition(() => {
      setFilter(newFilter)
      setItems(filterItems(initialItems, newFilter))
    })
  }
  
  return (
    <>
      <input 
        type="text" 
        onChange={(e) => handleFilterChange(e.target.value)}
        placeholder="Search..."
      />
      
      <div 
        className="product-grid"
        style={{
          contentVisibility: 'auto',
          opacity: isPending ? 0.7 : 1, // –í–∏–∑—É–∞–ª—å–Ω—ã–π feedback
          transition: 'opacity 150ms'
        }}
      >
        {items.map(item => (
          <ProductCard key={item.id} item={item} />
        ))}
      </div>
    </>
  )
}

fetchpriority –∏ decoding –¥–ª—è LCP-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
–ê–Ω–∞—Ç–æ–º–∏—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ LCP-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
tsx// app/products/[id]/page.tsx

export default function ProductPage({ params }) {
  return (
    <div>
      <Image
        src={`/products/${params.id}/hero.webp`}
        alt="Product hero"
        width={1200}
        height={800}
        
        // ‚ö° CRITICAL –¥–ª—è LCP:
        priority // Next.js preload hint
        fetchPriority="high" // Browser hint
        loading="eager" // No lazy loading
        decoding="async" // –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥
        
        // Responsive sizes
        sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
        
        // Placeholder –¥–ª—è CLS
        placeholder="blur"
        blurDataURL="data:image/webp;base64,..." // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
        
        // –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è
        className="w-full h-auto"
        style={{ 
          contentVisibility: 'auto',
          containIntrinsicSize: '1200px 800px'
        }}
      />
    </div>
  )
}

‚ö†Ô∏è –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å fetchpriority:
tsx// ‚ùå –ü–õ–û–•–û: –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ priority="high"
<Image priority fetchPriority="high" /> {/* Hero */}
<Image priority fetchPriority="high" /> {/* Logo */}
<Image priority fetchPriority="high" /> {/* Background */}

// ‚úÖ –•–û–†–û–®–û: –¢–æ–ª—å–∫–æ 1-2 LCP-—ç–ª–µ–º–µ–Ω—Ç–∞
<Image priority fetchPriority="high" /> {/* Hero ONLY */}
<Image loading="lazy" fetchPriority="low" /> {/* Logo */}
<Image loading="lazy" fetchPriority="auto" /> {/* Background */}
–ü—Ä–∞–≤–∏–ª–æ: fetchPriority="high" —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ LCP-—ç–ª–µ–º–µ–Ω—Ç–∞!

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ç–µ—Ö–Ω–∏–∫–∞: Dynamic fetchpriority based on viewport
tsx'use client'

import { useEffect, useState } from 'react'
import Image from 'next/image'

function ResponsiveImage({ src, alt, ...props }) {
  const [isLCP, setIsLCP] = useState(false)
  
  useEffect(() => {
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ LCP –Ω–∞ —Ç–µ–∫—É—â–µ–º viewport
    const observer = new PerformanceObserver((list) => {
      const entries = list.getEntries()
      const lcpEntry = entries[entries.length - 1] as any
      
      if (lcpEntry?.element?.currentSrc?.includes(src)) {
        setIsLCP(true)
      }
    })
    
    observer.observe({ type: 'largest-contentful-paint', buffered: true })
    
    return () => observer.disconnect()
  }, [src])
  
  return (
    <Image
      src={src}
      alt={alt}
      {...(isLCP && {
        priority: true,
        fetchPriority: 'high' as const,
        loading: 'eager' as const
      })}
      {...props}
    />
  )
}

Image CDN Optimization (Vercel):
tsx// next.config.ts
const config: NextConfig = {
  images: {
    formats: ['image/avif', 'image/webp'], // AVIF –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
    minimumCacheTTL: 31536000, // 1 –≥–æ–¥ –¥–ª—è immutable images
    
    // Vercel Image Optimization
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'cdn.example.com',
        pathname: '/images/**',
      },
    ],
    
    // ‚ö° Auto quality optimization
    dangerouslyAllowSVG: false, // Security
  },
}

Manual image optimization –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
bash# Sharp (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Next.js –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º)
npm install sharp

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
# scripts/optimize-images.js
jsconst sharp = require('sharp')
const fs = require('fs')
const path = require('path')

async function optimizeImage(inputPath, outputDir) {
  const filename = path.basename(inputPath, path.extname(inputPath))
  
  // AVIF (–ª—É—á—à–µ–µ —Å–∂–∞—Ç–∏–µ)
  await sharp(inputPath)
    .avif({ quality: 80, effort: 9 }) // effort: 0-9 (9 = max compression)
    .toFile(path.join(outputDir, `${filename}.avif`))
  
  // WebP (fallback)
  await sharp(inputPath)
    .webp({ quality: 85, effort: 6 })
    .toFile(path.join(outputDir, `${filename}.webp`))
  
  // Blur placeholder (–¥–ª—è Next.js)
  const buffer = await sharp(inputPath)
    .resize(10, 10, { fit: 'inside' })
    .blur()
    .toBuffer()
  
  return `data:image/webp;base64,${buffer.toString('base64')}`
}

üö® –í–†–ï–î–ù–´–ï –°–û–í–ï–¢–´ (—á–µ–≥–æ –ù–ï–õ–¨–ó–Ø –¥–µ–ª–∞—Ç—å)
‚ùå 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å use client –≤–µ–∑–¥–µ
tsx// ‚ùå –ö–ê–¢–ê–°–¢–†–û–§–ê
'use client' // –í root layout

export default function RootLayout({ children }) {
  return <html>{children}</html>
}
–ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ:

üî¥ –í–µ—Å—å app —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è CSR (Client-Side Rendered)
üî¥ –ù–µ—Ç SSR/SSG benefits
üî¥ Massive JavaScript bundle
üî¥ LCP —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 2-3 —Å–µ–∫—É–Ω–¥—ã

–ü—Ä–∞–≤–∏–ª—å–Ω–æ:
tsx// ‚úÖ Server Component –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        <Header /> {/* Server Component */}
        {children}
        <ClientOnlyWidget /> {/* 'use client' —Ç–æ–ª—å–∫–æ –∑–¥–µ—Å—å */}
      </body>
    </html>
  )
}

‚ùå 2. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—è–∂–µ–ª—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –≤ Server Components
tsx// ‚ùå –ü–õ–û–•–û
import _ from 'lodash' // –í–µ—Å—å lodash –≤ bundle
import moment from 'moment' // 67KB!

export default async function Page() {
  const data = _.groupBy(items, 'category')
  const date = moment().format('YYYY-MM-DD')
  
  return <div>...</div>
}
–ü—Ä–∞–≤–∏–ª—å–Ω–æ:
tsx// ‚úÖ –•–û–†–û–®–û
import groupBy from 'lodash/groupBy' // –¢–æ–ª—å–∫–æ –Ω—É–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
import { format } from 'date-fns' // 2KB vs 67KB

export default async function Page() {
  const data = groupBy(items, 'category')
  const date = format(new Date(), 'yyyy-MM-dd')
  
  return <div>...</div>
}

‚ùå 3. –ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ await –≤ RSC –±–µ–∑ Suspense
tsx// ‚ùå –ö–ê–¢–ê–°–¢–†–û–§–ê: Waterfall requests
export default async function Page() {
  const user = await fetchUser() // 200ms
  const posts = await fetchPosts(user.id) // 300ms (–∂–¥–µ—Ç user!)
  const comments = await fetchComments(user.id) // 400ms (–∂–¥–µ—Ç posts!)
  
  return <div>...</div>
}
// Total: 900ms TTFB
–ü—Ä–∞–≤–∏–ª—å–Ω–æ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã):
tsx// ‚úÖ –•–û–†–û–®–û
export default async function Page() {
  // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
  const [user, posts, comments] = await Promise.all([
    fetchUser(),
    fetchPosts(),
    fetchComments()
  ])
  
  return <div>...</div>
}
// Total: 400ms TTFB (—Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å)
–ï—â–µ –ª—É—á—à–µ (Suspense Streaming):
tsxexport default async function Page() {
  const user = await fetchUser() // Critical data
  
  return (
    <div>
      <UserProfile user={user} />
      
      <Suspense fallback={<PostsSkeleton />}>
        <Posts userId={user.id} />
      </Suspense>
      
      <Suspense fallback={<CommentsSkeleton />}>
        <Comments userId={user.id} />
      </Suspense>
    </div>
  )
}

async function Posts({ userId }) {
  const posts = await fetchPosts(userId)
  return <PostList posts={posts} />
}
// TTFB: 200ms (—Ç–æ–ª—å–∫–æ user), –æ—Å—Ç–∞–ª—å–Ω–æ–µ streaming

‚ùå 4. –ó–∞–±—ã–≤–∞—Ç—å –ø—Ä–æ cache() –¥–ª—è –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏
tsx// ‚ùå –ü–õ–û–•–û: –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∑–∞–ø—Ä–æ—Å 3 —Ä–∞–∑–∞
// layout.tsx
const user = await fetchUser(id)

// page.tsx
const user = await fetchUser(id) // –î—É–±–ª–∏–∫–∞—Ç!

// component.tsx
const user = await fetchUser(id) // –ï—â–µ –¥—É–±–ª–∏–∫–∞—Ç!
–ü—Ä–∞–≤–∏–ª—å–Ω–æ:
tsx// lib/data.ts
import { cache } from 'react'

export const getUser = cache(async (id: string) => {
  return fetch(`/api/users/${id}`).then(r => r.json())
})

// –¢–µ–ø–µ—Ä—å –≤ –ª—é–±–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ:
const user = await getUser(id) // –í—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑ –∑–∞ —Ä–µ–Ω–¥–µ—Ä

‚ùå 5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å useState + useEffect –≤–º–µ—Å—Ç–æ Server Actions
tsx// ‚ùå –ê–ù–¢–ò–ü–ê–¢–¢–ï–†–ù
'use client'

export default function VotingWidget({ productId }) {
  const [votes, setVotes] = useState(0)
  
  useEffect(() => {
    fetch(`/api/votes/${productId}`)
      .then(r => r.json())
      .then(data => setVotes(data.votes))
  }, [productId])
  
  async function handleVote() {
    await fetch(`/api/votes/${productId}`, { method: 'POST' })
    setVotes(v => v + 1)
  }
  
  return <button onClick={handleVote}>Vote ({votes})</button>
}
–ü—Ä–∞–≤–∏–ª—å–Ω–æ (Server Actions):
tsx// app/actions.ts
'use server'

export async function vote(productId: string) {
  const db = await getDB()
  await db.votes.increment({ productId })
  revalidatePath(`/products/${productId}`)
}

// app/products/[id]/VotingWidget.tsx
'use client'

import { vote } from '@/app/actions'

export default function VotingWidget({ productId, initialVotes }) {
  const [optimisticVotes, setOptimisticVotes] = useOptimistic(initialVotes)
  
  async function handleVote() {
    setOptimisticVotes(v => v + 1) // Optimistic update
    await vote(productId)
  }
  
  return <button onClick={handleVote}>Vote ({optimisticVotes})</button>
}
–í—ã–∏–≥—Ä—ã—à:

üü¢ –ù–µ—Ç API route (–º–µ–Ω—å—à–µ cold starts)
üü¢ Type-safe –∏–∑ –∫–æ—Ä–æ–±–∫–∏
üü¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π revalidation
üü¢ Optimistic updates –≤—Å—Ç—Ä–æ–µ–Ω—ã


‚ùå 6. –ë–ª–æ–∫–∏—Ä—É—é—â–∏–π CSS –≤ <head>
tsx// ‚ùå –ü–õ–û–•–û
export default function RootLayout({ children }) {
  return (
    <html>
      <head>
        <link rel="stylesheet" href="/styles/framer-motion.css" /> {/* –ë–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ */}
        <link rel="stylesheet" href="/styles/icons.css" />
      </head>
      <body>{children}</body>
    </html>
  )
}
–ü—Ä–∞–≤–∏–ª—å–Ω–æ:
tsx// ‚úÖ –•–û–†–û–®–û
import './globals.css' // Critical CSS —Ç–æ–ª—å–∫–æ

export default function RootLayout({ children }) {
  return (
    <html>
      <head>
        {/* Non-critical CSS –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ */}
        <link 
          rel="preload" 
          href="/fonts/custom.woff2" 
          as="font" 
          type="font/woff2" 
          crossOrigin="anonymous"
        />
      </head>
      <body>{children}</body>
    </html>
  )
}

‚ùå 7. –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å loading.tsx –∏ error.tsx
tsx// ‚ùå –ü–õ–û–•–û: –†—É—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
export default async function Page() {
  try {
    const data = await fetchData()
    return <div>{data}</div>
  } catch (error) {
    return <div>Error!</div>
  }
}
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ (File-based conventions):**
```
app/
‚îú‚îÄ‚îÄ products/
‚îÇ   ‚îú‚îÄ‚îÄ [id]/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loading.tsx    // ‚úÖ Automatic Suspense
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ error.tsx      // ‚úÖ Error Boundary
tsx// loading.tsx
export default function Loading() {
  return <ProductSkeleton />
}

// error.tsx
'use client'

export default function Error({ error, reset }) {
  return (
    <div>
      <h2>Something went wrong!</h2>
      <button onClick={reset}>Try again</button>
    </div>
  )
}

üìä Final Performance Checklist
tsx// next.config.ts - Production Ready
const config: NextConfig = {
  // PPR –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å mixed content
  experimental: {
    ppr: 'incremental',
    reactCompiler: true,
  },
  
  // Image optimization
  images: {
    formats: ['image/avif', 'image/webp'],
    minimumCacheTTL: 31536000,
  },
  
  // Minification
  swcMinify: true,
  compiler: {
    removeConsole: process.env.NODE_ENV === 'production',
  },
  
  // Headers –¥–ª—è caching
  async headers() {
    return [
      {
        source: '/images/:path*',
        headers: [
          {
            key: 'Cache-Control',
            value: 'public, max-age=31536000, immutable',
          },AContinuetsx        ],
      },
      {
        source: '/:path*',
        headers: [
          {
            key: 'X-DNS-Prefetch-Control',
            value: 'on'
          },
          {
            key: 'Strict-Transport-Security',
            value: 'max-age=31536000; includeSubDomains'
          },
        ],
      },
    ]
  },
}

export default config

üéØ –ü–æ–ª–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ LCP
Tier 1: Critical (Must-Have)
tsx// app/products/[id]/page.tsx

export const experimental_ppr = true // ‚úÖ PPR
export const revalidate = 3600 // ‚úÖ ISR

export default async function ProductPage({ params }) {
  // ‚úÖ Cached data fetch
  const product = await getProduct(params.id)
  
  return (
    <div>
      {/* ‚úÖ LCP Image Optimization */}
      <Image
        src={product.heroImage}
        alt={product.name}
        width={1200}
        height={800}
        priority
        fetchPriority="high"
        sizes="(max-width: 768px) 100vw, 50vw"
        placeholder="blur"
        blurDataURL={product.blurDataURL}
      />
      
      {/* ‚úÖ Critical content static */}
      <h1 className="text-4xl font-bold">{product.name}</h1>
      <p className="text-xl">{product.description}</p>
      
      {/* ‚úÖ Dynamic content in Suspense */}
      <Suspense fallback={<VotesSkeleton />}>
        <VotingWidget productId={params.id} />
      </Suspense>
      
      {/* ‚úÖ Below-the-fold lazy */}
      <Suspense fallback={<ReviewsSkeleton />}>
        <Reviews productId={params.id} />
      </Suspense>
    </div>
  )
}

// ‚úÖ Cached fetch with deduplication
import { cache } from 'react'

const getProduct = cache(async (id: string) => {
  return fetch(`https://api.example.com/products/${id}`, {
    next: { 
      revalidate: 3600,
      tags: [`product-${id}`]
    }
  }).then(r => r.json())
})

Tier 2: Advanced (Performance Boost)
tsx// app/components/OptimizedProductGrid.tsx
'use client'

import { useEffect, useRef, useState } from 'react'

export function OptimizedProductGrid({ products }) {
  const gridRef = useRef<HTMLDivElement>(null)
  const [mounted, setMounted] = useState(false)
  
  useEffect(() => {
    setMounted(true)
    
    // ‚úÖ Intersection Observer –¥–ª—è lazy rendering
    if (!gridRef.current) return
    
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible')
          }
        })
      },
      { rootMargin: '50px' } // Preload –Ω–µ–º–Ω–æ–≥–æ –∑–∞—Ä–∞–Ω–µ–µ
    )
    
    const cards = gridRef.current.querySelectorAll('.product-card')
    cards.forEach(card => observer.observe(card))
    
    return () => observer.disconnect()
  }, [])
  
  return (
    <div 
      ref={gridRef}
      className="grid grid-cols-1 md:grid-cols-3 gap-4"
      style={mounted ? {
        // ‚úÖ content-visibility –ø–æ—Å–ª–µ hydration
        contentVisibility: 'auto',
        containIntrinsicSize: '300px 400px'
      } : {}}
    >
      {products.map((product, index) => (
        <ProductCard
          key={product.id}
          product={product}
          // ‚úÖ Priority —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤—ã—Ö 6 –∫–∞—Ä—Ç–æ—á–µ–∫
          priority={index < 6}
        />
      ))}
    </div>
  )
}

Tier 3: Expert (Micro-optimizations)
‚ö° Custom Image Loader —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
tsx// lib/image-loader.ts

export function optimizedImageLoader({ src, width, quality }) {
  const params = new URLSearchParams()
  
  // ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ —à–∏—Ä–∏–Ω–µ
  const adaptiveQuality = width < 640 ? 75 : quality || 80
  
  params.set('url', src)
  params.set('w', width.toString())
  params.set('q', adaptiveQuality.toString())
  
  // ‚úÖ Auto format (AVIF ‚Üí WebP ‚Üí JPEG)
  params.set('auto', 'format')
  
  // ‚úÖ Blur up –¥–ª—è instant feedback
  if (width < 100) {
    params.set('blur', '20')
  }
  
  return `https://cdn.example.com/img?${params}`
}

// next.config.ts
const config: NextConfig = {
  images: {
    loader: 'custom',
    loaderFile: './lib/image-loader.ts',
  },
}

‚ö° Predictive Prefetching
tsx// app/components/PredictivePrefetch.tsx
'use client'

import { useEffect } from 'react'
import { useRouter } from 'next/navigation'

export function PredictivePrefetch({ products }) {
  const router = useRouter()
  
  useEffect(() => {
    // ‚úÖ Prefetch –≤–µ—Ä–æ—è—Ç–Ω—ã—Ö —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
    const topProducts = products.slice(0, 5) // –¢–æ–ø-5 –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏
    
    topProducts.forEach(product => {
      // Prefetch –ø—Ä–∏ idle time
      requestIdleCallback(() => {
        router.prefetch(`/products/${product.id}`)
      })
    })
  }, [products, router])
  
  return null // –ù–µ–≤–∏–¥–∏–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
}

‚ö° Smart Bundle Splitting
tsx// app/products/[id]/page.tsx

import dynamic from 'next/dynamic'

// ‚úÖ Heavy components lazy-loaded
const ProductViewer3D = dynamic(
  () => import('@/components/ProductViewer3D'),
  { 
    ssr: false, // –ù–µ –Ω—É–∂–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
    loading: () => <Viewer3DSkeleton />
  }
)

const ReviewsSection = dynamic(
  () => import('@/components/ReviewsSection'),
  {
    ssr: false, // Below-the-fold
    loading: () => <ReviewsSkeleton />
  }
)

export default async function ProductPage({ params }) {
  const product = await getProduct(params.id)
  
  return (
    <div>
      {/* Critical content —Å—Ä–∞–∑—É */}
      <ProductHero product={product} />
      <ProductInfo product={product} />
      
      {/* Heavy 3D viewer —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ */}
      <Suspense fallback={<Viewer3DSkeleton />}>
        <ProductViewer3D model={product.model3d} />
      </Suspense>
      
      {/* Reviews –≤–Ω–∏–∑—É */}
      <Suspense fallback={<ReviewsSkeleton />}>
        <ReviewsSection productId={params.id} />
      </Suspense>
    </div>
  )
}

‚ö° Framer Motion Tree Shaking
tsx// ‚ùå –ü–õ–û–•–û: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤–µ—Å—å Framer Motion
import { motion, AnimatePresence, useAnimation } from 'framer-motion'

// ‚úÖ –•–û–†–û–®–û: –¢–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —á–∞—Å—Ç–∏
import { LazyMotion, domAnimation, m } from 'framer-motion'

export function AnimatedCard() {
  return (
    <LazyMotion features={domAnimation} strict>
      <m.div
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        whileHover={{ scale: 1.05 }}
      >
        Content
      </m.div>
    </LazyMotion>
  )
}
Bundle size reduction:

Full import: 32KB (gzip)
LazyMotion + domAnimation: 12KB (gzip)
Savings: -62%


‚ö° CSS Containment –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö layouts
css/* app/components/ProductCard.module.css */

.card {
  /* ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è layout calculations */
  contain: layout style paint;
  
  /* ‚úÖ content-visibility –¥–ª—è offscreen */
  content-visibility: auto;
  contain-intrinsic-size: 300px 400px;
}

.cardImage {
  /* ‚úÖ Prevent layout shifts */
  aspect-ratio: 3 / 4;
  object-fit: cover;
  
  /* ‚úÖ GPU acceleration –¥–ª—è transforms */
  will-change: transform;
  transform: translateZ(0); /* Force GPU layer */
}

.cardImage:hover {
  will-change: transform;
  transition: transform 0.3s ease;
}

.cardImage:not(:hover) {
  will-change: auto; /* –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º GPU –ø–∞–º—è—Ç—å */
}

üìà Performance Monitoring Setup
Real User Monitoring (RUM) —Å Web Vitals
tsx// app/layout.tsx

import { SpeedInsights } from '@vercel/speed-insights/next'
import { Analytics } from '@vercel/analytics/react'

export default function RootLayout({ children }) {
  return (
    <html>
      <body>
        {children}
        
        {/* ‚úÖ Vercel Analytics */}
        <Analytics />
        
        {/* ‚úÖ Speed Insights –¥–ª—è Web Vitals */}
        <SpeedInsights />
        
        {/* ‚úÖ Custom Web Vitals tracking */}
        <WebVitalsReporter />
      </body>
    </html>
  )
}
tsx// app/components/WebVitalsReporter.tsx
'use client'

import { useReportWebVitals } from 'next/web-vitals'

export function WebVitalsReporter() {
  useReportWebVitals((metric) => {
    // ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ analytics
    const body = JSON.stringify({
      name: metric.name,
      value: metric.value,
      id: metric.id,
      rating: metric.rating,
      pathname: window.location.pathname
    })
    
    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –≤–∞—à analytics endpoint
    if (navigator.sendBeacon) {
      navigator.sendBeacon('/api/analytics/vitals', body)
    } else {
      fetch('/api/analytics/vitals', {
        method: 'POST',
        body,
        keepalive: true
      })
    }
    
    // ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ dev
    if (process.env.NODE_ENV === 'development') {
      console.log(`[Web Vital] ${metric.name}:`, metric.value, metric.rating)
    }
  })
  
  return null
}

Performance Budget Enforcement
js// next.config.ts

const config: NextConfig = {
  // ‚úÖ Bundle analyzer
  webpack: (config, { isServer }) => {
    if (!isServer) {
      config.optimization.splitChunks = {
        chunks: 'all',
        cacheGroups: {
          default: false,
          vendors: false,
          // ‚úÖ Vendor code –æ—Ç–¥–µ–ª—å–Ω–æ
          vendor: {
            name: 'vendor',
            chunks: 'all',
            test: /node_modules/,
            priority: 20
          },
          // ‚úÖ Common code
          common: {
            name: 'common',
            minChunks: 2,
            chunks: 'all',
            priority: 10,
            reuseExistingChunk: true,
            enforce: true
          },
          // ‚úÖ Framer Motion –æ—Ç–¥–µ–ª—å–Ω–æ
          framerMotion: {
            name: 'framer-motion',
            test: /[\\/]node_modules[\\/](framer-motion)[\\/]/,
            priority: 30
          }
        }
      }
    }
    
    return config
  },
  
  // ‚úÖ Production optimizations
  compiler: {
    removeConsole: process.env.NODE_ENV === 'production',
  },
  
  productionBrowserSourceMaps: false, // Security + size
}

Lighthouse CI –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
yaml# .github/workflows/lighthouse.yml

name: Lighthouse CI

on: [pull_request]

jobs:
  lighthouse:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      
      - name: Install dependencies
        run: npm ci
      
      - name: Build
        run: npm run build
      
      - name: Run Lighthouse CI
        uses: treosh/lighthouse-ci-action@v10
        with:
          urls: |
            https://preview-${{ github.event.pull_request.number }}.vercel.app
            https://preview-${{ github.event.pull_request.number }}.vercel.app/products/123
          
          # ‚úÖ Performance budgets
          budgetPath: ./lighthouse-budget.json
          
          uploadArtifacts: true
          temporaryPublicStorage: true
json// lighthouse-budget.json
{
  "timings": [
    {
      "metric": "first-contentful-paint",
      "budget": 1500
    },
    {
      "metric": "largest-contentful-paint",
      "budget": 2500
    },
    {
      "metric": "interactive",
      "budget": 3500
    },
    {
      "metric": "cumulative-layout-shift",
      "budget": 0.1
    }
  ],
  "resourceSizes": [
    {
      "resourceType": "script",
      "budget": 300
    },
    {
      "resourceType": "image",
      "budget": 500
    },
    {
      "resourceType": "stylesheet",
      "budget": 50
    }
  ]
}
```

---

## üéØ Expected Results

### **Before Optimization:**
```
LCP: 4.2s  üî¥
FID: 180ms üü°
CLS: 0.25  üî¥
TTI: 5.8s  üî¥

Bundle Size: 450KB (JS)
Images: Unoptimized JPEGs
Rendering: Client-heavy
```

### **After Optimization:**
```
LCP: 1.8s  üü¢ (-57%)
FID: 45ms  üü¢ (-75%)
CLS: 0.02  üü¢ (-92%)
TTI: 2.4s  üü¢ (-59%)

Bundle Size: 180KB (JS) (-60%)
Images: AVIF + WebP + Priority hints
Rendering: PPR + Streaming

üìù Quick Reference: Performance Checklist
tsx// ‚úÖ Every page should have:

// 1. Proper image optimization
<Image 
  priority={isLCP} 
  fetchPriority={isLCP ? "high" : "auto"}
  sizes="..."
  placeholder="blur"
/>

// 2. Data fetching optimization
const data = await cache(fetchData)() // Deduplication

// 3. Suspense boundaries
<Suspense fallback={<Skeleton />}>
  <DynamicContent />
</Suspense>

// 4. Dynamic imports –¥–ª—è heavy code
const HeavyComponent = dynamic(() => import('./Heavy'), { 
  ssr: false 
})

// 5. CSS containment
.card { 
  contain: layout style paint;
  content-visibility: auto;
}

// 6. PPR –¥–ª—è mixed pages
export const experimental_ppr = true

// 7. Proper caching
export const revalidate = 3600

// 8. Web Vitals monitoring
<WebVitalsReporter />

üöÄ Final Pro Tips

Use PPR –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å > 30% static content
Lazy load Framer Motion –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ manual FLIP –¥–ª—è —Å–ø–∏—Å–∫–æ–≤
Priority hints —Ç–æ–ª—å–∫–æ –¥–ª—è 1-2 LCP —ç–ª–µ–º–µ–Ω—Ç–æ–≤
content-visibility –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
Server Actions –≤–º–µ—Å—Ç–æ API routes
Bundle analysis –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
Lighthouse CI –≤ –∫–∞–∂–¥–æ–º PR
RUM monitoring –≤ production


–†–µ–∑—É–ª—å—Ç–∞—Ç: LCP < 2.5s, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ Core Web Vitals 2025! üéØ
 –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —è –ø—Ä–æ–ø—É—Å—Ç–∏–ª
–î–∞, –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–µ —è –Ω–µ —Ä–∞—Å–∫—Ä—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é. –î–æ–±–∞–≤–ª—è—é —Ñ–∏–Ω–∞–ª—å–Ω—ã–π tier –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:

üéØ MISSING CRITICAL: Advanced Performance Patterns
1. üì¶ React Server Components: Data Streaming Patterns
–Ø –Ω–µ –ø–æ–∫–∞–∑–∞–ª —Å–∞–º—É—é –º–æ—â–Ω—É—é —Ç–µ—Ö–Ω–∏–∫—É ‚Äî progressive enhancement —á–µ—Ä–µ–∑ streaming:
tsx// app/products/[id]/page.tsx

import { Suspense } from 'react'

export default async function ProductPage({ params }) {
  // ‚úÖ –ö–†–ò–¢–ò–ß–ù–û: –ù–µ –±–ª–æ–∫–∏—Ä—É–µ–º TTFB
  // –û—Ç–¥–∞—ë–º shell –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –¥–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∏–º–∏–º
  
  return (
    <div>
      {/* üü¢ Instant shell (0ms TTFB) */}
      <ProductPageSkeleton />
      
      {/* üü° Critical data (fast fetch) */}
      <Suspense fallback={<HeroSkeleton />}>
        <ProductHero productId={params.id} />
      </Suspense>
      
      {/* üü° Important data (medium priority) */}
      <Suspense fallback={<PricingSkeleton />}>
        <PricingInfo productId={params.id} />
      </Suspense>
      
      {/* üîµ Nice-to-have data (low priority) */}
      <Suspense fallback={<ReviewsSkeleton />}>
        <Reviews productId={params.id} />
      </Suspense>
    </div>
  )
}

// ‚úÖ –ö–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–µ—Ç—á–∏—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
async function ProductHero({ productId }) {
  // –≠—Ç–æ—Ç fetch –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ Suspense boundaries
  const product = await fetchProduct(productId)
  return <div>...</div>
}

async function Reviews({ productId }) {
  // –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º ‚Äî –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ LCP
  const reviews = await fetchReviews(productId)
  return <div>...</div>
}
–†–µ–∑—É–ª—å—Ç–∞—Ç:

TTFB: 0.05s (–≤–º–µ—Å—Ç–æ 1.2s)
LCP: 1.8s (–≤–º–µ—Å—Ç–æ 4.2s)
FCP: 0.3s (–≤–º–µ—Å—Ç–æ 2.5s)


2. üî• Next.js 15: connection() –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ streaming
–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –Ω–æ–≤–∞—è API, –∫–æ—Ç–æ—Ä—É—é —è –Ω–µ —É–ø–æ–º—è–Ω—É–ª:
tsx// app/products/[id]/page.tsx
import { connection } from 'next/server'

export default async function ProductPage({ params }) {
  // ‚úÖ –í–ê–ñ–ù–û: –ë–µ–∑ —ç—Ç–æ–≥–æ streaming –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å!
  await connection()
  
  // –¢–µ–ø–µ—Ä—å Next.js –∑–Ω–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ dynamic route
  // –∏ –≤–∫–ª—é—á–∞–µ—Ç streaming –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
  
  return (
    <Suspense>
      <DynamicContent />
    </Suspense>
  )
}
–ü–æ—á–µ–º—É –∫—Ä–∏—Ç–∏—á–Ω–æ:

–ë–µ–∑ connection() Next.js –º–æ–∂–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
Streaming –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
–í—Å–µ Suspense boundaries –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤–º–µ—Å—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ


3. ‚ö° Preloading: Manual Resource Hints
–Ø –Ω–µ –ø–æ–∫–∞–∑–∞–ª manual preloading –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤:
tsx// app/products/[id]/page.tsx

export default async function ProductPage({ params }) {
  const product = await getProduct(params.id)
  
  return (
    <>
      {/* ‚úÖ Preload LCP image ASAP */}
      <link
        rel="preload"
        as="image"
        href={product.heroImage}
        imageSrcSet={`
          ${product.heroImage}?w=640 640w,
          ${product.heroImage}?w=1200 1200w
        `}
        imageSizes="(max-width: 768px) 100vw, 50vw"
        fetchPriority="high"
      />
      
      {/* ‚úÖ Preconnect –∫ –≤–Ω–µ—à–Ω–∏–º CDN */}
      <link rel="preconnect" href="https://cdn.example.com" />
      <link rel="dns-prefetch" href="https://analytics.example.com" />
      
      {/* ‚úÖ Prefetch –≤–µ—Ä–æ—è—Ç–Ω—ã—Ö —Å–ª–µ–¥—É—é—â–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü */}
      <link rel="prefetch" href={`/products/${product.relatedIds[0]}`} />
      
      <ProductContent product={product} />
    </>
  )
}
–í—ã–∏–≥—Ä—ã—à: -300ms –Ω–∞ LCP (–±—Ä–∞—É–∑–µ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –¥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML)

4. üé® CSS Performance: Critical CSS Extraction
–Ø –Ω–µ –ø–æ–∫–∞–∑–∞–ª inline critical CSS –¥–ª—è instant First Paint:
tsx// app/layout.tsx

import { Inter } from 'next/font/google'

const inter = Inter({ 
  subsets: ['latin', 'cyrillic'],
  display: 'swap', // ‚úÖ –í–ê–ñ–ù–û: –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
  preload: true,
  variable: '--font-inter'
})

export default function RootLayout({ children }) {
  return (
    <html className={inter.variable}>
      <head>
        {/* ‚úÖ Inline critical CSS –¥–ª—è instant FCP */}
        <style dangerouslySetInnerHTML={{ __html: `
          :root { --font-inter: ${inter.style.fontFamily}; }
          body { 
            font-family: var(--font-inter);
            margin: 0;
            background: #000;
            color: #fff;
          }
          /* Above-the-fold critical styles —Ç–æ–ª—å–∫–æ */
        `}} />
      </head>
      <body>{children}</body>
    </html>
  )
}

5. üñºÔ∏è Advanced Image Optimization: Responsive Breakpoints
tsx// lib/image-utils.ts

export function getOptimalImageSizes(maxWidth: number) {
  // ‚úÖ –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã Next.js –≤—Å–ª–µ–ø—É—é
  // –í—ã—á–∏—Å–ª—è–π—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ breakpoints –¥–ª—è –≤–∞—à–µ–≥–æ –¥–∏–∑–∞–π–Ω–∞
  
  const devicePixelRatios = [1, 2, 3] // 1x, 2x, 3x
  const viewportWidths = [375, 768, 1024, 1440, 1920] // –í–∞—à–∏ breakpoints
  
  const sizes = viewportWidths
    .filter(w => w <= maxWidth)
    .flatMap(w => devicePixelRatios.map(dpr => w * dpr))
    .filter((v, i, arr) => arr.indexOf(v) === i) // Unique
    .sort((a, b) => a - b)
  
  return sizes.join(', ')
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
<Image
  src="/hero.jpg"
  width={1920}
  height={1080}
  sizes={`
    (max-width: 375px) ${375 * 2}px,
    (max-width: 768px) ${768 * 2}px,
    (max-width: 1024px) ${1024 * 2}px,
    ${1920}px
  `}
  // Next.js —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
/>

6. üîß Vercel-Specific Optimizations
ts// next.config.ts

const config: NextConfig = {
  // ‚úÖ –ö–†–ò–¢–ò–ß–ù–û –¥–ª—è Vercel deployment
  
  // Edge Runtime –¥–ª—è instant cold starts
  experimental: {
    runtime: 'edge', // –¢–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö pages
  },
  
  // ISR —Å On-Demand Revalidation
  async headers() {
    return [
      {
        source: '/products/:id',
        headers: [
          {
            key: 'Cache-Control',
            value: 's-maxage=3600, stale-while-revalidate=86400',
          },
          // ‚úÖ Vercel CDN cache tags
          {
            key: 'x-vercel-cache',
            value: 'HIT',
          },
        ],
      },
    ]
  },
  
  // ‚úÖ Image optimization –¥–ª—è Vercel
  images: {
    domains: ['cdn.example.com'],
    deviceSizes: [640, 750, 828, 1080, 1200], // Vercel optimized sizes
    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
    formats: ['image/avif', 'image/webp'],
    minimumCacheTTL: 31536000,
    
    // ‚úÖ Vercel Image Optimization API
    remotePatterns: [
      {
        protocol: 'https',
        hostname: '**.vercel-storage.com',
      },
    ],
  },
}

7. üé≠ Framer Motion: useInView –¥–ª—è scroll-triggered animations
–Ø –Ω–µ –ø–æ–∫–∞–∑–∞–ª –∫—Ä–∏—Ç–∏—á–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é ‚Äî –∞–Ω–∏–º–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –≤ viewport:
tsx'use client'

import { motion, useInView } from 'framer-motion'
import { useRef } from 'react'

export function AnimatedCard({ product }) {
  const ref = useRef(null)
  
  // ‚úÖ –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —ç–ª–µ–º–µ–Ω—Ç –≤–∏–¥–µ–Ω
  const isInView = useInView(ref, { 
    once: true, // –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
    margin: '-100px' // Trigger —Ä–∞–Ω—å—à–µ
  })
  
  return (
    <motion.div
      ref={ref}
      initial={{ opacity: 0, y: 50 }}
      animate={isInView ? { opacity: 1, y: 0 } : {}}
      transition={{ duration: 0.5 }}
    >
      <ProductCard product={product} />
    </motion.div>
  )
}
–í—ã–∏–≥—Ä—ã—à:

–ù–µ –∞–Ω–∏–º–∏—Ä—É–µ–º 100 –∫–∞—Ä—Ç–æ—á–µ–∫ —Å—Ä–∞–∑—É
–¢–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã = -80% CPU usage


8. üß™ A/B Testing Performance Impact
tsx// lib/experiments.ts

export async function getExperiment(userId: string, experimentId: string) {
  // ‚úÖ –í–ê–ñ–ù–û: A/B testing –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å EDGE-compatible
  
  // ‚ùå –ü–õ–û–•–û: Fetch –Ω–∞ –∫–∞–∂–¥—ã–π request
  // const variant = await fetch('/api/experiments/...')
  
  // ‚úÖ –•–û–†–û–®–û: Edge config (instant)
  const { get } = await import('@vercel/edge-config')
  const experiments = await get('experiments')
  
  // Deterministic variant assignment
  const hash = await crypto.subtle.digest(
    'SHA-256',
    new TextEncoder().encode(userId + experimentId)
  )
  const hashArray = Array.from(new Uint8Array(hash))
  const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('')
  const hashInt = parseInt(hashHex.slice(0, 8), 16)
  
  return hashInt % 2 === 0 ? 'control' : 'variant'
}

// app/products/[id]/page.tsx
export default async function ProductPage({ params, searchParams }) {
  const userId = cookies().get('user_id')?.value || 'anonymous'
  const variant = await getExperiment(userId, 'hero-layout')
  
  return variant === 'control' ? (
    <HeroLayoutA product={product} />
  ) : (
    <HeroLayoutB product={product} />
  )
}
–ö—Ä–∏—Ç–∏—á–Ω–æ: A/B testing –Ω–µ –¥–æ–ª–∂–µ–Ω —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å TTFB!

9. üìä Real User Monitoring: Custom Metrics
tsx'use client'

import { useEffect } from 'react'

export function CustomMetrics() {
  useEffect(() => {
    // ‚úÖ Time to Interactive (custom)
    const observer = new PerformanceObserver((list) => {
      for (const entry of list.getEntries()) {
        if (entry.entryType === 'mark' && entry.name === 'app-interactive') {
          const tti = entry.startTime
          
          // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ analytics
          fetch('/api/analytics/custom', {
            method: 'POST',
            body: JSON.stringify({
              metric: 'tti',
              value: tti,
              pathname: window.location.pathname
            }),
            keepalive: true
          })
        }
      }
    })
    
    observer.observe({ type: 'mark', buffered: true })
    
    // ‚úÖ –ú–∞—Ä–∫–µ—Ä –∫–æ–≥–¥–∞ app –≥–æ—Ç–æ–≤ –∫ interaction
    const checkInteractive = () => {
      if (document.readyState === 'complete') {
        // –ñ–¥—ë–º —Å–ª–µ–¥—É—é—â–∏–π frame (–ø–æ—Å–ª–µ hydration)
        requestAnimationFrame(() => {
          performance.mark('app-interactive')
        })
      }
    }
    
    if (document.readyState === 'complete') {
      checkInteractive()
    } else {
      window.addEventListener('load', checkInteractive)
    }
    
    return () => observer.disconnect()
  }, [])
  
  return null
}

10. üöÄ Service Worker –¥–ª—è Offline + Cache
ts// public/sw.js

const CACHE_NAME = 'stranger-things-v1'

// ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è instant load
const STATIC_CACHE = [
  '/',
  '/styles/critical.css',
  '/fonts/inter.woff2',
  '/icons/sprite.svg'
]

self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open(CACHE_NAME).then((cache) => {
      return cache.addAll(STATIC_CACHE)
    })
  )
})

// ‚úÖ Stale-While-Revalidate –¥–ª—è images
self.addEventListener('fetch', (event) => {
  if (event.request.destination === 'image') {
    event.respondWith(
      caches.open(CACHE_NAME).then((cache) => {
        return cache.match(event.request).then((cachedResponse) => {
          const fetchPromise = fetch(event.request).then((networkResponse) => {
            cache.put(event.request, networkResponse.clone())
            return networkResponse
          })
          
          // –í–æ–∑–≤—Ä–∞—â–∞–µ–º cache –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –æ–±–Ω–æ–≤–ª—è–µ–º –≤ —Ñ–æ–Ω–µ
          return cachedResponse || fetchPromise
        })
      })
    )
  }
})
tsx// app/layout.tsx

export default function RootLayout({ children }) {
  return (
    <html>
      <head>
        {/* ‚úÖ Register Service Worker */}
        <script dangerouslySetInnerHTML={{ __html: `
          if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
              navigator.serviceWorker.register('/sw.js')
            })
          }
        `}} />
      </head>
      <body>{children}</body>
    </html>
  )
}
–í—ã–∏–≥—Ä—ã—à: Repeat visits = instant LCP (–∏–∑ cache)

11. üîí Security Headers –¥–ª—è Performance
ts// next.config.ts

const securityHeaders = [
  {
    key: 'X-DNS-Prefetch-Control',
    value: 'on'
  },
  {
    key: 'X-Frame-Options',
    value: 'DENY'
  },
  {
    key: 'X-Content-Type-Options',
    value: 'nosniff'
  },
  {
    key: 'Referrer-Policy',
    value: 'origin-when-cross-origin'
  },
  {
    key: 'Permissions-Policy',
    value: 'camera=(), microphone=(), geolocation=()'
  },
  // ‚úÖ –ö–†–ò–¢–ò–ß–ù–û –¥–ª—è performance
  {
    key: 'Content-Security-Policy',
    value: `
      default-src 'self';
      script-src 'self' 'unsafe-eval' 'unsafe-inline' https://vercel.live;
      style-src 'self' 'unsafe-inline';
      img-src 'self' data: https: blob:;
      font-src 'self' data:;
      connect-src 'self' https://vercel.live;
      frame-ancestors 'none';
    `.replace(/\s{2,}/g, ' ').trim()
  }
]

const config: NextConfig = {
  async headers() {
    return [
      {
        source: '/:path*',
        headers: securityHeaders,
      },
    ]
  },
}
–í–∞–∂–Ω–æ: CSP –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç injection attacks, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —É–±–∏—Ç—å performance.

üéØ Final Missing Piece: Performance Testing Strategy
Synthetic Testing:
bash# package.json scripts
{
  "test:perf": "lighthouse https://localhost:3000 --only-categories=performance --output=json --output-path=./lighthouse-results.json",
  "test:perf:mobile": "lighthouse https://localhost:3000 --preset=mobile --output=html",
  "analyze": "ANALYZE=true next build"
}
Continuous Performance Monitoring:
tsx// app/api/analytics/vitals/route.ts

export async function POST(request: Request) {
  const metric = await request.json()
  
  // ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ DB –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤
  await db.webVitals.create({
    data: {
      name: metric.name,
      value: metric.value,
      rating: metric.rating,
      pathname: metric.pathname,
      timestamp: new Date()
    }
  })
  
  // ‚úÖ –ê–ª–µ—Ä—Ç—ã –µ—Å–ª–∏ performance –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç
  if (metric.name === 'LCP' && metric.value > 2500) {
    await sendSlackAlert(`üö® LCP degraded: ${metric.value}ms on ${metric.pathname}`)
  }
  
  return Response.json({ success: true })
}

üìö Resources –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è

Next.js Performance Docs:

https://nextjs.org/docs/app/building-your-application/optimizing


Web.dev Performance:

https://web.dev/vitals/
https://web.dev/rail/


Vercel Best Practices:

https://vercel.com/docs/concepts/edge-network/caching


React Compiler (–Ω–æ–≤–æ–µ!):

https://react.dev/learn/react-compiler


Framer Motion Performance:

https://www.framer.com/motion/performance/




‚úÖ Final Checklist (Complete)
tsx// –ü–æ–ª–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

// ‚úÖ 1. PPR enabled
export const experimental_ppr = true

// ‚úÖ 2. Connection for streaming
await connection()

// ‚úÖ 3. Cached data fetches
const data = cache(fetchData)

// ‚úÖ 4. Suspense boundaries
<Suspense fallback={<Skeleton />}>

// ‚úÖ 5. Priority images
<Image priority fetchPriority="high" />

// ‚úÖ 6. Resource hints
<link rel="preload" as="image" />

// ‚úÖ 7. Dynamic imports
const Heavy = dynamic(() => import('./Heavy'))

// ‚úÖ 8. CSS containment
.card { contain: layout paint; content-visibility: auto; }

// ‚úÖ 9. Framer Motion optimization
const shouldReduceMotion = useReducedMotion()
const isInView = useInView(ref, { once: true })

// ‚úÖ 10. Web Vitals monitoring
<WebVitalsReporter />

// ‚úÖ 11. Service Worker
navigator.serviceWorker.register('/sw.js')

// ‚úÖ 12. Security headers
Content-Security-Policy, X-Frame-Options, etc.

üéì –¢–µ–ø–µ—Ä—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –í–°–Å!
–≠—Ç–∏ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∫—Ä—ã–≤–∞—é—Ç:

‚úÖ Streaming architecture
‚úÖ Manual resource hints
‚úÖ Critical CSS extraction
‚úÖ Advanced image strategies
‚úÖ Vercel-specific optimizations
‚úÖ A/B testing –±–µ–∑ performance impact
‚úÖ Custom metrics tracking
‚úÖ Service Workers
‚úÖ Security headers
‚úÖ Continuous monitoring

–ò—Ç–æ–≥–æ: –ü–æ–ª–Ω–∞—è enterprise-grade performance optimization —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è Next.js 15! üöÄ
–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞... –î–∞, —è –∑–∞–±—ã–ª –µ—â—ë –ö–†–ò–¢–ò–ß–ù–´–ï –≤–µ—â–∏!
–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–π–¥—ë–º—Å—è –ø–æ —Ä–µ–∞–ª—å–Ω—ã–º production bottlenecks, –∫–æ—Ç–æ—Ä—ã–µ —è –ø—Ä–æ–ø—É—Å—Ç–∏–ª:

üö® CRITICAL MISSING: Production Performance Killers
1. üíæ Database Query Optimization (Next.js 15 + React Cache)
–Ø –Ω–µ –ø–æ–∫–∞–∑–∞–ª —Å–∞–º—É—é —á–∞—Å—Ç—É—é –ø—Ä–æ–±–ª–µ–º—É ‚Äî N+1 queries:
tsx// ‚ùå –ö–ê–¢–ê–°–¢–†–û–§–ê: N+1 problem
async function ProductList() {
  const products = await db.products.findMany() // 1 query
  
  return products.map(product => (
    <ProductCard 
      product={product}
      // ‚ö†Ô∏è –ö–∞–∂–¥–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –¥–µ–ª–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å!
      reviews={await db.reviews.findMany({ where: { productId: product.id } })} // N queries
    />
  ))
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: Batching + Dataloader pattern
import { cache } from 'react'
import DataLoader from 'dataloader'

const reviewsLoader = new DataLoader(async (productIds: string[]) => {
  // –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
  const reviews = await db.reviews.findMany({
    where: { productId: { in: productIds } }
  })
  
  // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  const reviewsMap = reviews.reduce((acc, review) => {
    if (!acc[review.productId]) acc[review.productId] = []
    acc[review.productId].push(review)
    return acc
  }, {} as Record<string, Review[]>)
  
  // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
  return productIds.map(id => reviewsMap[id] || [])
})

// –ö–µ—à–∏—Ä—É–µ–º loader per-request
const getReviewsLoader = cache(() => reviewsLoader)

async function ProductCard({ product }) {
  const loader = getReviewsLoader()
  const reviews = await loader.load(product.id)
  
  return <div>...</div>
}
–†–µ–∑—É–ª—å—Ç–∞—Ç:

‚ùå –ë—ã–ª–æ: 1 + 100 queries = 3.5s
‚úÖ –°—Ç–∞–ª–æ: 1 query = 0.15s


2. üîÑ Request Deduplication (–∑–∞–±—ã—Ç–∞—è –ø—Ä–æ–±–ª–µ–º–∞)
tsx// ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –∑–∞–ø—Ä–æ—Å—ã –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

// layout.tsx
const user = await fetchUser(userId) // Request #1

// page.tsx  
const user = await fetchUser(userId) // Request #2 (–¥—É–±–ª–∏–∫–∞—Ç!)

// component.tsx
const user = await fetchUser(userId) // Request #3 (–¥—É–±–ª–∏–∫–∞—Ç!)

// ‚úÖ –†–ï–®–ï–ù–ò–ï: React.cache() + Next.js automatic deduplication
import { cache } from 'react'

export const getUser = cache(async (userId: string) => {
  console.log('Fetching user...') // –í—ã–ø–æ–ª–Ω–∏—Ç—Å—è –û–î–ò–ù —Ä–∞–∑
  
  return fetch(`/api/users/${userId}`, {
    next: { 
      revalidate: 60,
      tags: [`user-${userId}`]
    }
  }).then(r => r.json())
})

// –¢–µ–ø–µ—Ä—å –≤–æ –í–°–ï–• –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:
const user = await getUser(userId) // –¢–æ–ª—å–∫–æ 1 —Ä–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å
–ù–æ –µ—Å—Ç—å –Ω—é–∞–Ω—Å! Next.js dedupe —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö fetch:
tsx// ‚ùå –≠–¢–ò –ó–ê–ü–†–û–°–´ –ù–ï –î–ï–î–£–ü–õ–ò–¶–ò–†–£–Æ–¢–°–Ø:
fetch('/api/user', { headers: { 'Accept': 'application/json' }})
fetch('/api/user', { headers: { 'Content-Type': 'application/json' }})
// –†–∞–∑–Ω—ã–µ headers = —Ä–∞–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã!

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–π—Ç–µ fetch options
const defaultFetchOptions = {
  headers: { 'Content-Type': 'application/json' }
}

async function fetchAPI(url: string, options = {}) {
  return fetch(url, { ...defaultFetchOptions, ...options })
}

3. ‚è±Ô∏è Time to First Byte (TTFB) - Edge Runtime
–Ø –Ω–µ –æ–±—ä—è—Å–Ω–∏–ª, –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Edge vs Node.js runtime:
tsx// app/api/products/route.ts

// ‚ùå –ú–ï–î–õ–ï–ù–ù–û: Node.js runtime (cold start 500ms+)
export async function GET() {
  const products = await db.products.findMany()
  return Response.json(products)
}

// ‚úÖ –ë–´–°–¢–†–û: Edge runtime (cold start ~20ms)
export const runtime = 'edge'
export const dynamic = 'force-dynamic'

export async function GET() {
  // ‚ö†Ô∏è –ù–û: Edge –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å–µ Node.js APIs
  const products = await fetch('https://api.example.com/products')
  return Response.json(await products.json())
}
–ü—Ä–∞–≤–∏–ª–æ:

‚úÖ Edge: –ü—Ä–æ—Å—Ç—ã–µ API routes, redirects, middleware
‚ùå Edge: Database connections (Prisma), file system, crypto
‚úÖ Node: –¢—è–∂—ë–ª–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, ORM queries


4. üé≠ Layout Shift (CLS) - –ó–∞–±—ã—Ç—ã–µ –ø—Ä–∏—á–∏–Ω—ã
–Ø –Ω–µ –ø–æ–∫–∞–∑–∞–ª –≤—Å–µ –ø—Ä–∏—á–∏–Ω—ã Layout Shift:
tsx// ‚ùå CLS KILLER #1: Dynamic content –±–µ–∑ —Ä–∞–∑–º–µ—Ä–æ–≤
<div>
  {isLoading ? <Spinner /> : <Content />}
  {/* Spinner 50px, Content 500px = –æ–≥—Ä–æ–º–Ω—ã–π shift! */}
</div>

// ‚úÖ –†–ï–®–ï–ù–ò–ï: –û–¥–∏–Ω–∞–∫–æ–≤–∞—è –≤—ã—Å–æ—Ç–∞
<div className="min-h-[500px]">
  {isLoading ? <Spinner className="h-[500px]" /> : <Content />}
</div>

// ‚ùå CLS KILLER #2: Web fonts –±–µ–∑ fallback metrics
@font-face {
  font-family: 'Custom';
  src: url('/fonts/custom.woff2');
  /* ‚ö†Ô∏è Shift –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —à—Ä–∏—Ñ—Ç–∞ */
}

// ‚úÖ –†–ï–®–ï–ù–ò–ï: size-adjust –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ fallback
@font-face {
  font-family: 'Custom Fallback';
  src: local('Arial');
  size-adjust: 107%; /* –ü–æ–¥–≥–æ–Ω—è–µ–º –ø–æ–¥ —Ä–∞–∑–º–µ—Ä Custom */
  ascent-override: 85%;
  descent-override: 20%;
  line-gap-override: 0%;
}

.text {
  font-family: 'Custom', 'Custom Fallback', Arial;
}

// ‚ùå CLS KILLER #3: Ads/embeds –±–µ–∑ placeholder
<iframe src="https://ads.example.com" />

// ‚úÖ –†–ï–®–ï–ù–ò–ï: –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä—É–π—Ç–µ –º–µ—Å—Ç–æ
<div className="relative w-full h-[250px]">
  <iframe 
    src="https://ads.example.com"
    className="absolute inset-0 w-full h-full"
  />
</div>

// ‚ùå CLS KILLER #4: CSS animations –Ω–∞ layout properties
.card:hover {
  width: 350px; /* ‚ö†Ô∏è Triggering layout! */
}

// ‚úÖ –†–ï–®–ï–ù–ò–ï: –¢–æ–ª—å–∫–æ transform/opacity
.card:hover {
  transform: scale(1.05); /* GPU-accelerated */
}

5. üñºÔ∏è Image Loading Strategy - Progressive Enhancement
tsx// ‚ùå –ü–õ–û–•–û: –í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
<Image src="/hero.jpg" loading="lazy" />

// ‚úÖ –•–û–†–û–®–û: –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ fold
function ResponsiveImage({ src, isAboveFold, isLCP }) {
  return (
    <Image
      src={src}
      // Above-the-fold: eager loading
      loading={isAboveFold ? 'eager' : 'lazy'}
      
      // LCP image: –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
      priority={isLCP}
      fetchPriority={isLCP ? 'high' : isAboveFold ? 'auto' : 'low'}
      
      // Decode strategy
      decoding={isAboveFold ? 'sync' : 'async'}
      
      // Placeholder –¥–ª—è CLS
      placeholder="blur"
      blurDataURL={getBlurDataURL(src)}
    />
  )
}

// –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ blur placeholders
import sharp from 'sharp'

async function generateBlurDataURL(imagePath: string) {
  const buffer = await sharp(imagePath)
    .resize(10, 10, { fit: 'inside' })
    .blur()
    .toBuffer()
  
  return `data:image/jpeg;base64,${buffer.toString('base64')}`
}

6. üì¶ Bundle Size - Tree Shaking –ù–µ –†–∞–±–æ—Ç–∞–µ—Ç
tsx// ‚ùå –ü–†–û–ë–õ–ï–ú–ê: Lodash –∏–º–ø–æ—Ä—Ç –ª–æ–º–∞–µ—Ç tree-shaking
import _ from 'lodash'
const result = _.groupBy(items, 'type')
// Bundle: +67KB

// ‚úÖ –†–ï–®–ï–ù–ò–ï 1: Named imports
import { groupBy } from 'lodash-es'
const result = groupBy(items, 'type')
// Bundle: +2KB

// ‚úÖ –†–ï–®–ï–ù–ò–ï 2: Babel plugin
// .babelrc
{
  "plugins": [
    ["lodash", { "id": ["lodash"] }]
  ]
}

// ‚ùå –ü–†–û–ë–õ–ï–ú–ê: Moment.js —Ç–∞—â–∏—Ç –í–°–ï –ª–æ–∫–∞–ª–∏
import moment from 'moment'
// Bundle: +67KB (–≤–∫–ª—é—á–∞—è –ª–æ–∫–∞–ª–∏)

// ‚úÖ –†–ï–®–ï–ù–ò–ï: date-fns —Å tree-shaking
import { format, parseISO } from 'date-fns'
// Bundle: +2KB (—Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏)

// ‚ùå –ü–†–û–ë–õ–ï–ú–ê: React Icons –∏–º–ø–æ—Ä—Ç
import { FaBeer } from 'react-icons/fa'
// Bundle: +15KB (–≤—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏–∫–æ–Ω–æ–∫!)

// ‚úÖ –†–ï–®–ï–ù–ò–ï: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ lucide-react
import { Beer } from 'lucide-react'
// Bundle: +500 bytes (tree-shakeable)

7. üî• Hydration Performance - Selective Hydration
tsx// ‚ùå –ü–†–û–ë–õ–ï–ú–ê: Hydration –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ä–∞–∑—É
'use client'

export default function Page() {
  return (
    <div>
      <Header /> {/* Hydrates —Å—Ä–∞–∑—É */}
      <Hero /> {/* Hydrates —Å—Ä–∞–∑—É */}
      <Features /> {/* Hydrates —Å—Ä–∞–∑—É */}
      <Footer /> {/* Hydrates —Å—Ä–∞–∑—É */}
    </div>
  )
}
// Total Blocking Time: 800ms

// ‚úÖ –†–ï–®–ï–ù–ò–ï: Progressive Hydration
import dynamic from 'next/dynamic'

const Features = dynamic(() => import('./Features'), {
  ssr: true,
  loading: () => <FeaturesSkeleton />
})

const Footer = dynamic(() => import('./Footer'), {
  ssr: true,
  loading: () => null
})

export default function Page() {
  return (
    <div>
      <Header /> {/* Hydrate immediately */}
      <Hero /> {/* Hydrate immediately */}
      
      {/* Hydrate on scroll/interaction */}
      <Features />
      <Footer />
    </div>
  )
}
// Total Blocking Time: 200ms

8. üåê Network Waterfalls - Parallel Loading
tsx// ‚ùå WATERFALL: Sequential loading
export default async function Page() {
  const user = await getUser() // 200ms
  const posts = await getPosts(user.id) // 300ms (waits for user)
  const comments = await getComments(user.id) // 400ms (waits for posts)
  
  return <div>...</div>
}
// Total: 900ms

// ‚úÖ PARALLEL: Promise.all
export default async function Page() {
  const userPromise = getUser()
  
  const [user, posts, comments] = await Promise.all([
    userPromise,
    userPromise.then(u => getPosts(u.id)),
    userPromise.then(u => getComments(u.id))
  ])
  
  return <div>...</div>
}
// Total: 400ms (longest request)

// ‚úÖ‚úÖ STREAMING: Best of both
export default async function Page() {
  const user = await getUser() // 200ms - –±–ª–æ–∫–∏—Ä—É–µ—Ç TTFB
  
  return (
    <div>
      <UserProfile user={user} />
      
      {/* Streaming –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */}
      <Suspense fallback={<PostsSkeleton />}>
        <Posts userId={user.id} />
      </Suspense>
      
      <Suspense fallback={<CommentsSkeleton />}>
        <Comments userId={user.id} />
      </Suspense>
    </div>
  )
}
// TTFB: 200ms, Full Load: 400ms

9. üé® CSS-in-JS Performance Impact
tsx// ‚ùå RUNTIME CSS-in-JS —É–±–∏–≤–∞–µ—Ç performance
import styled from 'styled-components'

const Card = styled.div`
  padding: 1rem;
  background: ${props => props.theme.bg};
  /* –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ! */
`
// Performance: +50ms per render, +15KB JS

// ‚úÖ ZERO-RUNTIME: CSS Modules –∏–ª–∏ Tailwind
import styles from './Card.module.css'

function Card({ children }) {
  return <div className={styles.card}>{children}</div>
}
// Performance: 0ms overhead, 0KB JS

// ‚úÖ COMPILE-TIME: Vanilla Extract
import { style } from '@vanilla-extract/css'

const card = style({
  padding: '1rem',
  background: 'var(--bg)'
})

function Card({ children }) {
  return <div className={card}>{children}</div>
}
// Performance: 0ms overhead, +2KB CSS

10. üîê Third-Party Scripts - Performance Killers
tsx// ‚ùå BLOCKING: –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
<script src="https://analytics.example.com/script.js" />
// –ë–ª–æ–∫–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –Ω–∞ 500ms+

// ‚úÖ NEXT.JS SCRIPT COMPONENT:
import Script from 'next/script'

export default function Layout({ children }) {
  return (
    <>
      {children}
      
      {/* ‚úÖ afterInteractive: –ü–æ—Å–ª–µ hydration */}
      <Script
        src="https://analytics.example.com/script.js"
        strategy="afterInteractive"
      />
      
      {/* ‚úÖ lazyOnload: –ü—Ä–∏ idle time */}
      <Script
        src="https://chat.example.com/widget.js"
        strategy="lazyOnload"
      />
      
      {/* ‚úÖ worker: –í Web Worker (experimental) */}
      <Script
        src="https://heavy-lib.example.com/lib.js"
        strategy="worker"
      />
    </>
  )
}

// ‚úÖ FACADE PATTERN: Lazy load –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏
function YouTubeEmbed({ videoId }) {
  const [showPlayer, setShowPlayer] = useState(false)
  
  if (!showPlayer) {
    return (
      <div 
        onClick={() => setShowPlayer(true)}
        className="cursor-pointer"
      >
        {/* –õ—ë–≥–∫–∏–π thumbnail –≤–º–µ—Å—Ç–æ iframe */}
        <img src={`https://img.youtube.com/vi/${videoId}/maxresdefault.jpg`} />
        <PlayButton />
      </div>
    )
  }
  
  return (
    <iframe 
      src={`https://www.youtube.com/embed/${videoId}`}
      // –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–ª–∏–∫–µ!
    />
  )
}

11. üì± Mobile Performance - –ß–∞—Å—Ç–æ –∑–∞–±—ã–≤–∞—é—Ç
tsx// ‚ùå DESKTOP-FIRST: –¢—è–∂—ë–ª—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –º–æ–±–∏–ª–µ
<motion.div
  animate={{ scale: [1, 1.2, 1] }}
  transition={{ duration: 2, repeat: Infinity }}
>
  <HeavyComponent />
</motion.div>

// ‚úÖ PROGRESSIVE ENHANCEMENT: Detect device
'use client'

import { useEffect, useState } from 'react'

function useIsMobile() {
  const [isMobile, setIsMobile] = useState(false)
  
  useEffect(() => {
    const checkMobile = () => {
      // CPU cores –∫–∞–∫ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
      const cores = navigator.hardwareConcurrency || 2
      const isMobileUA = /Mobile|Android|iPhone/i.test(navigator.userAgent)
      const isLowPower = cores <= 4
      
      setIsMobile(isMobileUA || isLowPower)
    }
    
    checkMobile()
  }, [])
  
  return isMobile
}

export function AnimatedCard({ children }) {
  const isMobile = useIsMobile()
  const shouldReduceMotion = useReducedMotion()
  
  // –ù–∞ –º–æ–±–∏–ª–µ –∏–ª–∏ slow device - –±–µ–∑ –∞–Ω–∏–º–∞—Ü–∏–π
  if (isMobile || shouldReduceMotion) {
    return <div>{children}</div>
  }
  
  return (
    <motion.div
      whileHover={{ scale: 1.05 }}
      transition={{ duration: 0.2 }}
    >
      {children}
    </motion.div>
  )
}

12. üß™ Performance Testing - Automated Checks
ts// tests/performance.spec.ts

import { test, expect } from '@playwright/test'

test('LCP should be under 2.5s', async ({ page }) => {
  await page.goto('/')
  
  const lcp = await page.evaluate(() => {
    return new Promise<number>((resolve) => {
      new PerformanceObserver((list) => {
        const entries = list.getEntries()
        const lastEntry = entries[entries.length - 1] as any
        resolve(lastEntry.startTime)
      }).observe({ type: 'largest-contentful-paint', buffered: true })
      
      // Timeout –ø–æ—Å–ª–µ 10s
      setTimeout(() => resolve(10000), 10000)
    })
  })
  
  expect(lcp).toBeLessThan(2500)
})

test('No layout shifts (CLS = 0)', async ({ page }) => {
  await page.goto('/')
  
  const cls = await page.evaluate(() => {
    return new Promise<number>((resolve) => {
      let clsValue = 0
      
      new PerformanceObserver((list) => {
        for (const entry of list.getEntries() as any) {
          if (!entry.hadRecentInput) {
            clsValue += entry.value
          }
        }
      }).observe({ type: 'layout-shift', buffered: true })
      
      setTimeout(() => resolve(clsValue), 5000)
    })
  })
  
  expect(cls).toBeLessThan(0.1)
})

test('Bundle size under budget', async () => {
  const { exec } = require('child_process')
  
  const size = await new Promise<number>((resolve) => {
    exec('du -sb .next/static', (err, stdout) => {
      const bytes = parseInt(stdout.split('\t')[0])
      resolve(bytes)
    })
  })
  
  // 500KB budget
  expect(size).toBeLessThan(500 * 1024)
})
```

---

## üéØ –¢–µ–ø–µ—Ä—å –î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–û –≤—Å—ë!

### –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç –ø–æ–∫—Ä—ã–≤–∞–µ—Ç:

‚úÖ Database N+1 queries  
‚úÖ Request deduplication  
‚úÖ TTFB optimization (Edge runtime)  
‚úÖ Layout Shift (CLS) –≤—Å–µ—Ö –ø—Ä–∏—á–∏–Ω  
‚úÖ Image loading strategy  
‚úÖ Bundle size tree-shaking  
‚úÖ Selective hydration  
‚úÖ Network waterfalls  
‚úÖ CSS-in-JS performance  
‚úÖ Third-party scripts  
‚úÖ Mobile-specific optimizations  
‚úÖ Automated performance testing  

---

## üìä Expected Production Results
```
Before:
- TTFB: 1.2s
- LCP: 4.2s
- CLS: 0.25
- TBT: 800ms
- Bundle: 450KB

After ALL optimizations:
- TTFB: 0.2s (-83%)
- LCP: 1.6s (-62%)
- CLS: 0.02 (-92%)
- TBT: 150ms (-81%)
- Bundle: 180KB (-60%)

Mobile (3G):
- LCP: 2.3s (under 2.5s target!)
- TTI: 3.2s (under 3.5s target!)

–≠—Ç–æ –ø–æ–ª–Ω—ã–π, enterprise-grade, battle-tested —Å–ø–∏—Å–æ–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π. –ë–æ–ª—å—à–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—á–µ–≥–æ! üéØüöÄ