# E2E тестирование с Playwright

## Установка

Playwright уже установлен в проекте. Для установки браузеров выполните:

```bash
npx playwright install chromium
```

## Запуск тестов

### Запуск всех тестов
```bash
npm run test:e2e
```

### Запуск с UI (интерактивный режим)
```bash
npm run test:e2e:ui
```

### Запуск конкретного теста
```bash
npx playwright test tests/stress-voting.spec.ts
```

## Тесты

### `tests/stress-voting.spec.ts`

**Цель:** Проверить, что UI не зависает при быстром голосовании.

**Что проверяет:**
1. Заходит на страницу каталога (`/catalog`)
2. Находит первые 10 карточек эффектов с кнопками голосования
3. Очень быстро (без пауз) кликает по варианту "Как я помню" в каждой карточке
4. Проверяет, что интерфейс не завис (страница реагирует на скролл)
5. Проверяет, что счетчик в хедере обновился
6. Проверяет, что в localStorage записались данные (минимум 10 голосов)

**Селекторы:**
- Кнопки голосования: `div.cursor-pointer:has-text("Как я помню")` (исключая вариант B с классом `.bg-cyan-950`)
- Счетчик голосов: текст в формате `X/25` или просто число в хедере

**Ожидаемое поведение:**
- Все клики должны выполниться без блокировки UI
- Скролл должен работать сразу после кликов
- Счетчик должен обновиться
- localStorage должен содержать минимум 10 записей

## Конфигурация

Конфигурация Playwright находится в `playwright.config.ts`:
- Базовый URL: `http://localhost:3000`
- Автоматический запуск dev-сервера перед тестами
- Используется только Chromium для быстрых тестов

## Отладка

### Просмотр отчетов
После запуска тестов откройте HTML отчет:
```bash
npx playwright show-report
```

### Запуск в режиме отладки
```bash
npx playwright test --debug
```

### Скриншоты и видео
Playwright автоматически сохраняет скриншоты и видео при падении тестов в папку `test-results/`.

